
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library for time series forecasting using machine learning models. It works with any regressor compatible with the scikit-learn API, including popular options like LightGBM, XGBoost, CatBoost, Keras, and many others.">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://skforecast.org/0.16.0/api/model_selection.html">
      
      
        <link rel="prev" href="Sarimax.html">
      
      
        <link rel="next" href="feature_selection.html">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>model_selection - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-GR8X9Z9LKL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model_selection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  <div class="md-banner md-banner--warning">
  This is documentation for an unstable development version.
  
    <a href="../.." id="version-switch-link">
      <strong>Switch to latest stable version.</strong>
    </a>
  
</div>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL(".."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              model_selection
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/skforecast/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../index.html" class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
        
  
  
    
  
  Intro to Forecasting

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../quick-start/quick-start-skforecast.html" class="md-tabs__link">
          
  
  
  Quick start

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../user_guides/table-of-contents.html" class="md-tabs__link">
          
  
  
  User Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../examples/examples_english.html" class="md-tabs__link">
          
  
  
  Examples and tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="ForecasterRecursive.html" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../faq/table-of-contents.html" class="md-tabs__link">
          
  
  
  FAQ and Tips

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../releases/releases.html" class="md-tabs__link">
        
  
  
    
  
  Releases

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../more/about-skforecast.html" class="md-tabs__link">
          
  
  
  More

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/skforecast/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome to skforecast
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to Forecasting
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Quick start
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Quick start
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/quick-start-skforecast.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-parameters.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecaster Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-attributes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecaster Attributes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/how-to-install.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to install
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/how-to-install-copy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to install 2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/table-of-contents.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Table of contents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/migration-guide.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Skforecast 0.14 Migration guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Input data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Single series Forecasters
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Single series Forecasters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursive multi-step forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Direct multi-step forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ARIMA and SARIMAX forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-baseline.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecasting baseline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Global Forecasters (multiple series)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Global Forecasters (multiple series)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Independent multi-time series forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/multi-series-with-different-length-and-different_exog.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Series with different lengths and different exogenous variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dependent multivariate series forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-with-deep-learning-rnn-lstm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deep learning Recurrent Neural Networks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Feature Engineering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Feature Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exogenous variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/window-features-and-custom-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Window and custom features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Categorical features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/calendar-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calendars features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data transformation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/time-series-differentiation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Differentiation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-selection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature selection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sktime-pipelines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sktime pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Evaluation and Tuning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Model Evaluation and Tuning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/metrics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backtesting forecaster
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hyperparameter tuning and lags selection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-selection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature selection
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Probabilistic Forecasting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Probabilistic Forecasting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting-overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting-bootstrapped-residuals.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bootstrapped residuals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting-conformal-prediction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conformal predictions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting-conformal-calibration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conformal calibration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting-quantile-regression.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantile forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting-global-models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Probabilistic global models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting-metrics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics in probabilistic forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/probabilistic-forecasting-crps-score.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continuous Ranked Probability Score (CRPS)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/explainability.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Explainability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model deployment
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Model deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Save and load forecaster
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecaster in production
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plotting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/datasets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Additional Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            Additional Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/training-and-prediction-matrices.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extract training and prediction matrices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Weighted time series forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/stacking-ensemble-models-forecasting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stacking multiple models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecasting with XGBoost and LightGBM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Skforecast in GPU
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    FAQ and forecasting tips
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            FAQ and forecasting tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Avoid negative predictions when forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecasting time series with missing values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-with-delayed-historical-data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecasting with delayed historical data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parameters-search-backtesting-vs-one-step-ahead.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backtesting vs One-step-ahead
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/probabilistic-forecasting-crps-score.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continuous Ranked Probability Score (CRPS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/probabilistic-forecasting-calibrate-intervals.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calibration of probabilistic forecasting intervals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cyclical features in time series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-aggregation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time series aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parallelization in skforecast
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Profiling skforecast
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples and tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples and tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples_english.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    English
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples_spanish.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spanish
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    recursive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            recursive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRecursive.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ForecasterRecursive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRecursiveMultiSeries.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ForecasterRecursiveMultiSeries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ForecasterSarimax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterEquivalentDate.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ForecasterEquivalentDate
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    direct
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            direct
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterDirect.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ForecasterDirect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterDirectMultiVariate.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ForecasterDirectMultiVariate
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    deep_learning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            deep_learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRnn.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ForecasterRnn
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Sarimax.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sarimax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    model_selection
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="model_selection.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    model_selection
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._validation.backtesting_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      backtesting_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.grid_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      grid_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.random_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      random_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.bayesian_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      bayesian_search_forecaster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._validation.backtesting_forecaster_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      backtesting_forecaster_multiseries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.grid_search_forecaster_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      grid_search_forecaster_multiseries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.random_search_forecaster_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      random_search_forecaster_multiseries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.bayesian_search_forecaster_multiseries" class="md-nav__link">
    <span class="md-ellipsis">
      bayesian_search_forecaster_multiseries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._validation.backtesting_sarimax" class="md-nav__link">
    <span class="md-ellipsis">
      backtesting_sarimax
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.grid_search_sarimax" class="md-nav__link">
    <span class="md-ellipsis">
      grid_search_sarimax
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._search.random_search_sarimax" class="md-nav__link">
    <span class="md-ellipsis">
      random_search_sarimax
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold" class="md-nav__link">
    <span class="md-ellipsis">
      BaseFold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.steps" class="md-nav__link">
    <span class="md-ellipsis">
      steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.initial_train_size" class="md-nav__link">
    <span class="md-ellipsis">
      initial_train_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.window_size" class="md-nav__link">
    <span class="md-ellipsis">
      window_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.differentiation" class="md-nav__link">
    <span class="md-ellipsis">
      differentiation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.refit" class="md-nav__link">
    <span class="md-ellipsis">
      refit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.fixed_train_size" class="md-nav__link">
    <span class="md-ellipsis">
      fixed_train_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.gap" class="md-nav__link">
    <span class="md-ellipsis">
      gap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.skip_folds" class="md-nav__link">
    <span class="md-ellipsis">
      skip_folds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.allow_incomplete_fold" class="md-nav__link">
    <span class="md-ellipsis">
      allow_incomplete_fold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.return_all_indexes" class="md-nav__link">
    <span class="md-ellipsis">
      return_all_indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.verbose" class="md-nav__link">
    <span class="md-ellipsis">
      verbose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold._validate_params" class="md-nav__link">
    <span class="md-ellipsis">
      _validate_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold._extract_index" class="md-nav__link">
    <span class="md-ellipsis">
      _extract_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.BaseFold.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      set_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.TimeSeriesFold" class="md-nav__link">
    <span class="md-ellipsis">
      TimeSeriesFold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeSeriesFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.TimeSeriesFold._repr_html_" class="md-nav__link">
    <span class="md-ellipsis">
      _repr_html_
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.TimeSeriesFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.TimeSeriesFold._print_info" class="md-nav__link">
    <span class="md-ellipsis">
      _print_info
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.OneStepAheadFold" class="md-nav__link">
    <span class="md-ellipsis">
      OneStepAheadFold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OneStepAheadFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.OneStepAheadFold._repr_html_" class="md-nav__link">
    <span class="md-ellipsis">
      _repr_html_
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.OneStepAheadFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.model_selection._split.OneStepAheadFold._print_info" class="md-nav__link">
    <span class="md-ellipsis">
      _print_info
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._utils.initialize_lags_grid" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_lags_grid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._utils.check_backtesting_input" class="md-nav__link">
    <span class="md-ellipsis">
      check_backtesting_input
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._utils.check_one_step_ahead_input" class="md-nav__link">
    <span class="md-ellipsis">
      check_one_step_ahead_input
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skforecast.model_selection._utils.select_n_jobs_backtesting" class="md-nav__link">
    <span class="md-ellipsis">
      select_n_jobs_backtesting
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="feature_selection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    feature_selection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="preprocessing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    preprocessing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="metrics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="experimental.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    experimental
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datasets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    FAQ and Tips
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            FAQ and Tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/table-of-contents.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Table of contents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Avoid negative predictions when forecasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecasting time series with missing values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-with-delayed-historical-data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forecasting with delayed historical data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parameters-search-backtesting-vs-one-step-ahead.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backtesting vs One-step-ahead
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cyclical features in time series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-aggregation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time series aggregation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/probabilistic-forecasting-crps-score.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continuous Ranked Probability Score (CRPS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/probabilistic-forecasting-calibrate-intervals.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calibration of probabilistic forecasting intervals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parallelization in skforecast
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Profiling skforecast
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    More
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            More
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../more/about-skforecast.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About skforecast
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../more/consulting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Consulting & Professional services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../more/funding.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funding
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="model_selection"><code>model_selection</code><a class="headerlink" href="#model_selection" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._validation.backtesting_forecaster" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._validation.backtesting_forecaster</span>


<a href="#skforecast.model_selection._validation.backtesting_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">backtesting_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval_method</span><span class="o">=</span><span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_predictors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Backtesting of forecaster model following the folds generated by the TimeSeriesFold
class and using the metric(s) provided.</p>
<p>If <code>forecaster</code> is already trained and <code>initial_train_size</code> is set to <code>None</code> in the
TimeSeriesFold class, no initial train will be done and all data will be used
to evaluate the model. However, the first <code>len(forecaster.last_window)</code> observations
are needed to create the initial predictors, so no predictions are calculated for
them.</p>
<p>A copy of the original forecaster is created so that it is not modified during 
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursive">ForecasterRecursive</span>, <span title="ForecasterDirect">ForecasterDirect</span>, <span title="ForecasterEquivalentDate">ForecasterEquivalentDate</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies whether probabilistic predictions should be estimated and the 
method to use. The following options are supported:</p>
<ul>
<li>If <code>float</code>, represents the nominal (expected) coverage (between 0 and 1). 
For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code> percentiles.</li>
<li>If <code>list</code> or <code>tuple</code>: Sequence of percentiles to compute, each value must 
be between 0 and 100 inclusive. For example, a 95% confidence interval can 
be specified as <code>interval = [2.5, 97.5]</code> or multiple percentiles (e.g. 10, 
50 and 90) as <code>interval = [10, 50, 90]</code>.</li>
<li>If 'bootstrapping' (str): <code>n_boot</code> bootstrapping predictions will be generated.</li>
<li>If scipy.stats distribution object, the distribution parameters will
be estimated for each prediction.</li>
<li>If None, no probabilistic predictions are estimated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval_method</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction intervals. Available options:</p>
<ul>
<li>'bootstrapping': Bootstrapping is used to generate prediction 
intervals [1]_.</li>
<li>'conformal': Employs the conformal prediction split method for 
interval estimation [2]_.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;bootstrapping&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when estimating prediction
intervals.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions. 
If <code>False</code>, out of sample residuals (calibration) are used. 
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected based on the predicted values 
(binned selection).
If <code>False</code>, residuals are selected randomly.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to ensure reproducibility.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_predictors</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the predictors used to make the predictions are also returned.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and validation sets used 
for backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>metric_values</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value(s) of the metric(s).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>backtest_predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of predictions. The  DataFrame includes the following columns:</p>
<ul>
<li>pred: Predicted values for the corresponding series and time steps.</li>
</ul>
<p>If <code>interval</code> is not <code>None</code>, additional columns are included depending on the method:</p>
<ul>
<li>For <code>float</code>: Columns <code>lower_bound</code> and <code>upper_bound</code>.</li>
<li>For <code>list</code> or <code>tuple</code> of 2 elements: Columns <code>lower_bound</code> and <code>upper_bound</code>.</li>
<li>For <code>list</code> or <code>tuple</code> with multiple percentiles: One column per percentile 
(e.g., <code>p_10</code>, <code>p_50</code>, <code>p_90</code>).</li>
<li>For <code>'bootstrapping'</code>: One column per bootstrapping iteration 
(e.g., <code>pred_boot_0</code>, <code>pred_boot_1</code>, ..., <code>pred_boot_n</code>).</li>
<li>For <code>scipy.stats</code> distribution objects: One column for each estimated 
parameter of the distribution (e.g., <code>loc</code>, <code>scale</code>).</li>
</ul>
<p>If <code>return_predictors</code> is <code>True</code>:</p>
<ul>
<li>fold: Indicates the fold number where the prediction was made.</li>
<li>One column per predictor is created.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="references" open>
  <summary>References</summary>
  <p>.. [1] Forecasting: Principles and Practice (3<sup>rd</sup> ed) Rob J Hyndman and George Athanasopoulos.
       <a href="https://otexts.com/fpp3/prediction-intervals.html">https://otexts.com/fpp3/prediction-intervals.html</a></p>
<p>.. [2] MAPIE - Model Agnostic Prediction Interval Estimator.
       <a href="https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method">https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</a></p>
</details>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_validation.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">backtesting_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_predictors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting of forecaster model following the folds generated by the TimeSeriesFold</span>
<span class="sd">    class and using the metric(s) provided.</span>

<span class="sd">    If `forecaster` is already trained and `initial_train_size` is set to `None` in the</span>
<span class="sd">    TimeSeriesFold class, no initial train will be done and all data will be used</span>
<span class="sd">    to evaluate the model. However, the first `len(forecaster.last_window)` observations</span>
<span class="sd">    are needed to create the initial predictors, so no predictions are calculated for</span>
<span class="sd">    them.</span>

<span class="sd">    A copy of the original forecaster is created so that it is not modified during </span>
<span class="sd">    the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursive, ForecasterDirect, ForecasterEquivalentDate</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default None</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    interval : float, list, tuple, str, object, default None</span>
<span class="sd">        Specifies whether probabilistic predictions should be estimated and the </span>
<span class="sd">        method to use. The following options are supported:</span>

<span class="sd">        - If `float`, represents the nominal (expected) coverage (between 0 and 1). </span>
<span class="sd">        For instance, `interval=0.95` corresponds to `[2.5, 97.5]` percentiles.</span>
<span class="sd">        - If `list` or `tuple`: Sequence of percentiles to compute, each value must </span>
<span class="sd">        be between 0 and 100 inclusive. For example, a 95% confidence interval can </span>
<span class="sd">        be specified as `interval = [2.5, 97.5]` or multiple percentiles (e.g. 10, </span>
<span class="sd">        50 and 90) as `interval = [10, 50, 90]`.</span>
<span class="sd">        - If &#39;bootstrapping&#39; (str): `n_boot` bootstrapping predictions will be generated.</span>
<span class="sd">        - If scipy.stats distribution object, the distribution parameters will</span>
<span class="sd">        be estimated for each prediction.</span>
<span class="sd">        - If None, no probabilistic predictions are estimated.</span>
<span class="sd">    interval_method : str, default &#39;bootstrapping&#39;</span>
<span class="sd">        Technique used to estimate prediction intervals. Available options:</span>

<span class="sd">        - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction </span>
<span class="sd">        intervals [1]_.</span>
<span class="sd">        - &#39;conformal&#39;: Employs the conformal prediction split method for </span>
<span class="sd">        interval estimation [2]_.</span>
<span class="sd">    n_boot : int, default 250</span>
<span class="sd">        Number of bootstrapping iterations to perform when estimating prediction</span>
<span class="sd">        intervals.</span>
<span class="sd">    use_in_sample_residuals : bool, default True</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create predictions. </span>
<span class="sd">        If `False`, out of sample residuals (calibration) are used. </span>
<span class="sd">        Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<span class="sd">        `set_out_sample_residuals()` method.</span>
<span class="sd">    use_binned_residuals : bool, default True</span>
<span class="sd">        If `True`, residuals are selected based on the predicted values </span>
<span class="sd">        (binned selection).</span>
<span class="sd">        If `False`, residuals are selected randomly.</span>
<span class="sd">    random_state : int, default 123</span>
<span class="sd">        Seed for the random number generator to ensure reproducibility.</span>
<span class="sd">    return_predictors : bool, default False</span>
<span class="sd">        If `True`, the predictors used to make the predictions are also returned.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metric_values : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s).</span>
<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Value of predictions. The  DataFrame includes the following columns:</span>

<span class="sd">        - pred: Predicted values for the corresponding series and time steps.</span>

<span class="sd">        If `interval` is not `None`, additional columns are included depending on the method:</span>

<span class="sd">        - For `float`: Columns `lower_bound` and `upper_bound`.</span>
<span class="sd">        - For `list` or `tuple` of 2 elements: Columns `lower_bound` and `upper_bound`.</span>
<span class="sd">        - For `list` or `tuple` with multiple percentiles: One column per percentile </span>
<span class="sd">        (e.g., `p_10`, `p_50`, `p_90`).</span>
<span class="sd">        - For `&#39;bootstrapping&#39;`: One column per bootstrapping iteration </span>
<span class="sd">        (e.g., `pred_boot_0`, `pred_boot_1`, ..., `pred_boot_n`).</span>
<span class="sd">        - For `scipy.stats` distribution objects: One column for each estimated </span>
<span class="sd">        parameter of the distribution (e.g., `loc`, `scale`).</span>

<span class="sd">        If `return_predictors` is `True`:</span>

<span class="sd">        - fold: Indicates the fold number where the prediction was made.</span>
<span class="sd">        - One column per predictor is created.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<span class="sd">           https://otexts.com/fpp3/prediction-intervals.html</span>

<span class="sd">    .. [2] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<span class="sd">           https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaters_allowed</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ForecasterRecursive&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ForecasterDirect&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterEquivalentDate&#39;</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecaters_allowed</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`forecaster` must be of type </span><span class="si">{</span><span class="n">forecaters_allowed</span><span class="si">}</span><span class="s2">, for all other types of &quot;</span>
            <span class="sa">f</span><span class="s2">&quot; forecasters use the functions available in the other `model_selection` &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;modules.&quot;</span>
        <span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>              <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">cv</span>                      <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">y</span>                       <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">metric</span>                  <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">interval</span>                <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">interval_method</span>         <span class="o">=</span> <span class="n">interval_method</span><span class="p">,</span>
        <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
        <span class="n">use_binned_residuals</span>    <span class="o">=</span> <span class="n">use_binned_residuals</span><span class="p">,</span>
        <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">return_predictors</span>       <span class="o">=</span> <span class="n">return_predictors</span><span class="p">,</span>
        <span class="n">n_jobs</span>                  <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">show_progress</span>           <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster</span><span class="p">(</span>
        <span class="n">forecaster</span>              <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                       <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                      <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">metric</span>                  <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">interval</span>                <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">interval_method</span>         <span class="o">=</span> <span class="n">interval_method</span><span class="p">,</span>
        <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
        <span class="n">use_binned_residuals</span>    <span class="o">=</span> <span class="n">use_binned_residuals</span><span class="p">,</span>
        <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">return_predictors</span>       <span class="o">=</span> <span class="n">return_predictors</span><span class="p">,</span>
        <span class="n">n_jobs</span>                  <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>                 <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>           <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.grid_search_forecaster" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._search.grid_search_forecaster</span>


<a href="#skforecast.model_selection._search.grid_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">grid_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Exhaustive search over specified parameter values for a Forecaster object.
Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursive">ForecasterRecursive</span>, <span title="ForecasterDirect">ForecasterDirect</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_grid</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags_grid</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">grid_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
        <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a Forecaster object.</span>
<span class="sd">    Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursive, ForecasterDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default None</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    lags_grid : list, dict, default None</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>
<span class="sd">    return_best : bool, default True</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default None</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
                  <span class="n">forecaster</span>    <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                  <span class="n">y</span>             <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                  <span class="n">cv</span>            <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                  <span class="n">param_grid</span>    <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                  <span class="n">metric</span>        <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                  <span class="n">exog</span>          <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                  <span class="n">lags_grid</span>     <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                  <span class="n">return_best</span>   <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                  <span class="n">n_jobs</span>        <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                  <span class="n">verbose</span>       <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                  <span class="n">show_progress</span> <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                  <span class="n">output_file</span>   <span class="o">=</span> <span class="n">output_file</span>
              <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.random_search_forecaster" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._search.random_search_forecaster</span>


<a href="#skforecast.model_selection._search.random_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">random_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursive">ForecasterRecursive</span>, <span title="ForecasterDirect">ForecasterDirect</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_distributions</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and 
distributions or lists of parameters to try.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags_grid</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_iter</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled per lags configuration. 
n_iter trades off runtime vs quality of the solution.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
        <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursive, ForecasterDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and </span>
<span class="sd">        distributions or lists of parameters to try.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default None</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i]. </span>
<span class="sd">    lags_grid : list, dict, default None</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>
<span class="sd">    n_iter : int, default 10</span>
<span class="sd">        Number of parameter settings that are sampled per lags configuration. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>
<span class="sd">    random_state : int, default 123</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default True</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default None</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
                  <span class="n">forecaster</span>    <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                  <span class="n">y</span>             <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                  <span class="n">cv</span>            <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                  <span class="n">param_grid</span>    <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                  <span class="n">metric</span>        <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                  <span class="n">exog</span>          <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                  <span class="n">lags_grid</span>     <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                  <span class="n">return_best</span>   <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                  <span class="n">n_jobs</span>        <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                  <span class="n">verbose</span>       <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                  <span class="n">show_progress</span> <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                  <span class="n">output_file</span>   <span class="o">=</span> <span class="n">output_file</span>
              <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.bayesian_search_forecaster" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._search.bayesian_search_forecaster</span>


<a href="#skforecast.model_selection._search.bayesian_search_forecaster" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">bayesian_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">search_space</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kwargs_create_study</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">kwargs_study_optimize</span><span class="o">=</span><span class="p">{},</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Bayesian search for hyperparameters of a Forecaster object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursive">ForecasterRecursive</span>, <span title="ForecasterDirect">ForecasterDirect</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>search_space</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>(<span title="optuna">optuna</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function with argument <code>trial</code> which returns a dictionary with parameters names 
(<code>str</code>) as keys and Trial object from optuna (trial.suggest_float, 
trial.suggest_int, trial.suggest_categorical) as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_trials</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled in each lag configuration.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the sampling for reproducible output. When a new sampler 
is passed in <code>kwargs_create_study</code>, the seed must be set within the 
sampler. For example <code>{'sampler': TPESampler(seed=145)}</code>.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs_create_study</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments (key, value mappings) to pass to optuna.create_study().
If default, the direction is set to 'minimize' and a TPESampler(seed=123) 
sampler is used during optimization.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs_study_optimize</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments (key, value mappings) to pass to study.optimize().</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column lags: lags configuration for each iteration.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>best_trial</code></td>            <td>
                  <code>optuna object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The best optimization result returned as a FrozenTrial optuna object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bayesian_search_forecaster</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
    <span class="n">search_space</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kwargs_create_study</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kwargs_study_optimize</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian search for hyperparameters of a Forecaster object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursive, ForecasterDirect</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    search_space : Callable (optuna)</span>
<span class="sd">        Function with argument `trial` which returns a dictionary with parameters names </span>
<span class="sd">        (`str`) as keys and Trial object from optuna (trial.suggest_float, </span>
<span class="sd">        trial.suggest_int, trial.suggest_categorical) as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default None</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    n_trials : int, default 10</span>
<span class="sd">        Number of parameter settings that are sampled in each lag configuration.</span>
<span class="sd">    random_state : int, default 123</span>
<span class="sd">        Sets a seed to the sampling for reproducible output. When a new sampler </span>
<span class="sd">        is passed in `kwargs_create_study`, the seed must be set within the </span>
<span class="sd">        sampler. For example `{&#39;sampler&#39;: TPESampler(seed=145)}`.</span>
<span class="sd">    return_best : bool, default True</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default None</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>
<span class="sd">    kwargs_create_study : dict, default {}</span>
<span class="sd">        Additional keyword arguments (key, value mappings) to pass to optuna.create_study().</span>
<span class="sd">        If default, the direction is set to &#39;minimize&#39; and a TPESampler(seed=123) </span>
<span class="sd">        sampler is used during optimization.</span>
<span class="sd">    kwargs_study_optimize : dict, default {}</span>
<span class="sd">        Additional keyword arguments (key, value mappings) to pass to study.optimize().</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>
<span class="sd">    best_trial : optuna object</span>
<span class="sd">        The best optimization result returned as a FrozenTrial optuna object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">return_best</span> <span class="ow">and</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`exog` must have same number of samples as `y`. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">), length `y`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

    <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span> <span class="o">=</span> <span class="n">_bayesian_search_optuna</span><span class="p">(</span>
                              <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                              <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
                              <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                              <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                              <span class="n">search_space</span>          <span class="o">=</span> <span class="n">search_space</span><span class="p">,</span>
                              <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                              <span class="n">n_trials</span>              <span class="o">=</span> <span class="n">n_trials</span><span class="p">,</span>
                              <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                              <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                              <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                              <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                              <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                              <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span><span class="p">,</span>
                              <span class="n">kwargs_create_study</span>   <span class="o">=</span> <span class="n">kwargs_create_study</span><span class="p">,</span>
                              <span class="n">kwargs_study_optimize</span> <span class="o">=</span> <span class="n">kwargs_study_optimize</span>
                          <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._validation.backtesting_forecaster_multiseries" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._validation.backtesting_forecaster_multiseries</span>


<a href="#skforecast.model_selection._validation.backtesting_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">backtesting_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">add_aggregated_metric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval_method</span><span class="o">=</span><span class="s2">&quot;conformal&quot;</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_predictors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Backtesting of forecaster model following the folds generated by the TimeSeriesFold
class and using the metric(s) provided.</p>
<p>If <code>forecaster</code> is already trained and <code>initial_train_size</code> is set to <code>None</code> in the
TimeSeriesFold class, no initial train will be done and all data will be used
to evaluate the model. However, the first <code>len(forecaster.last_window)</code> observations
are needed to create the initial predictors, so no predictions are calculated for
them.</p>
<p>A copy of the original forecaster is created so that it is not modified during 
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursiveMultiSeries">ForecasterRecursiveMultiSeries</span>, <span title="ForecasterDirectMultiVariate">ForecasterDirectMultiVariate</span>, <span title="ForecasterRnn">ForecasterRnn</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels will be predicted.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_aggregated_metric</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, and multiple series (<code>levels</code>) are predicted, the aggregated
metrics (average, weighted average and pooled) are also returned.</p>
<ul>
<li>'average': the average (arithmetic mean) of all levels.</li>
<li>'weighted_average': the average of the metrics weighted by the number of
predicted values of each level.</li>
<li>'pooling': the values of all levels are pooled and then the metric is
calculated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies whether probabilistic predictions should be estimated and the 
method to use. The following options are supported:</p>
<ul>
<li>If <code>float</code>, represents the nominal (expected) coverage (between 0 and 1). 
For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code> percentiles.</li>
<li>If <code>list</code> or <code>tuple</code>: Sequence of percentiles to compute, each value must 
be between 0 and 100 inclusive. For example, a 95% confidence interval can 
be specified as <code>interval = [2.5, 97.5]</code> or multiple percentiles (e.g. 10, 
50 and 90) as <code>interval = [10, 50, 90]</code>.</li>
<li>If 'bootstrapping' (str): <code>n_boot</code> bootstrapping predictions will be generated.</li>
<li>If scipy.stats distribution object, the distribution parameters will
be estimated for each prediction.</li>
<li>If None, no probabilistic predictions are estimated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval_method</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction intervals. Available options:</p>
<ul>
<li>'bootstrapping': Bootstrapping is used to generate prediction 
intervals [1]_.</li>
<li>'conformal': Employs the conformal prediction split method for 
interval estimation [2]_.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;conformal&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when estimating prediction 
intervals.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions. 
If <code>False</code>, out of sample residuals (calibration) are used. 
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected based on the predicted values 
(binned selection).
If <code>False</code>, residuals are selected randomly.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to ensure reproducibility.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_predictors</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the predictors used to make the predictions are also returned.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and validation sets used 
for backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the backtesting 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>metrics_levels</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value(s) of the metric(s). Index are the levels and columns the metrics.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>backtest_predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Long-format DataFrame containing the predicted values for each series. The 
DataFrame includes the following columns:</p>
<ul>
<li><code>level</code>: Identifier for the time series or level being predicted.</li>
<li><code>pred</code>: Predicted values for the corresponding series and time steps.</li>
</ul>
<p>If <code>interval</code> is not <code>None</code>, additional columns are included depending on the method:</p>
<ul>
<li>For <code>float</code>: Columns <code>lower_bound</code> and <code>upper_bound</code>.</li>
<li>For <code>list</code> or <code>tuple</code> of 2 elements: Columns <code>lower_bound</code> and <code>upper_bound</code>.</li>
<li>For <code>list</code> or <code>tuple</code> with multiple percentiles: One column per percentile 
(e.g., <code>p_10</code>, <code>p_50</code>, <code>p_90</code>).</li>
<li>For <code>'bootstrapping'</code>: One column per bootstrapping iteration 
(e.g., <code>pred_boot_0</code>, <code>pred_boot_1</code>, ..., <code>pred_boot_n</code>).</li>
<li>For <code>scipy.stats</code> distribution objects: One column for each estimated 
parameter of the distribution (e.g., <code>loc</code>, <code>scale</code>).</li>
</ul>
<p>If <code>return_predictors</code> is <code>True</code>:</p>
<ul>
<li>fold: Indicates the fold number where the prediction was made.</li>
<li>One column per predictor is created.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="references" open>
  <summary>References</summary>
  <p>.. [1] Forecasting: Principles and Practice (3<sup>rd</sup> ed) Rob J Hyndman and George Athanasopoulos.
       <a href="https://otexts.com/fpp3/prediction-intervals.html">https://otexts.com/fpp3/prediction-intervals.html</a></p>
<p>.. [2] MAPIE - Model Agnostic Prediction Interval Estimator.
       <a href="https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method">https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</a></p>
</details>

            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_validation.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">backtesting_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">levels</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">add_aggregated_metric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;conformal&#39;</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_predictors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting of forecaster model following the folds generated by the TimeSeriesFold</span>
<span class="sd">    class and using the metric(s) provided.</span>

<span class="sd">    If `forecaster` is already trained and `initial_train_size` is set to `None` in the</span>
<span class="sd">    TimeSeriesFold class, no initial train will be done and all data will be used</span>
<span class="sd">    to evaluate the model. However, the first `len(forecaster.last_window)` observations</span>
<span class="sd">    are needed to create the initial predictors, so no predictions are calculated for</span>
<span class="sd">    them.</span>

<span class="sd">    A copy of the original forecaster is created so that it is not modified during </span>
<span class="sd">    the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate, ForecasterRnn</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    levels : str, list, default None</span>
<span class="sd">        Time series to be predicted. If `None` all levels will be predicted.</span>
<span class="sd">    add_aggregated_metric : bool, default True</span>
<span class="sd">        If `True`, and multiple series (`levels`) are predicted, the aggregated</span>
<span class="sd">        metrics (average, weighted average and pooled) are also returned.</span>

<span class="sd">        - &#39;average&#39;: the average (arithmetic mean) of all levels.</span>
<span class="sd">        - &#39;weighted_average&#39;: the average of the metrics weighted by the number of</span>
<span class="sd">        predicted values of each level.</span>
<span class="sd">        - &#39;pooling&#39;: the values of all levels are pooled and then the metric is</span>
<span class="sd">        calculated.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default None</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    interval : float, list, tuple, str, object, default None</span>
<span class="sd">        Specifies whether probabilistic predictions should be estimated and the </span>
<span class="sd">        method to use. The following options are supported:</span>

<span class="sd">        - If `float`, represents the nominal (expected) coverage (between 0 and 1). </span>
<span class="sd">        For instance, `interval=0.95` corresponds to `[2.5, 97.5]` percentiles.</span>
<span class="sd">        - If `list` or `tuple`: Sequence of percentiles to compute, each value must </span>
<span class="sd">        be between 0 and 100 inclusive. For example, a 95% confidence interval can </span>
<span class="sd">        be specified as `interval = [2.5, 97.5]` or multiple percentiles (e.g. 10, </span>
<span class="sd">        50 and 90) as `interval = [10, 50, 90]`.</span>
<span class="sd">        - If &#39;bootstrapping&#39; (str): `n_boot` bootstrapping predictions will be generated.</span>
<span class="sd">        - If scipy.stats distribution object, the distribution parameters will</span>
<span class="sd">        be estimated for each prediction.</span>
<span class="sd">        - If None, no probabilistic predictions are estimated.</span>
<span class="sd">    interval_method : str, default &#39;conformal&#39;</span>
<span class="sd">        Technique used to estimate prediction intervals. Available options:</span>

<span class="sd">        - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction </span>
<span class="sd">        intervals [1]_.</span>
<span class="sd">        - &#39;conformal&#39;: Employs the conformal prediction split method for </span>
<span class="sd">        interval estimation [2]_.</span>
<span class="sd">    n_boot : int, default 250</span>
<span class="sd">        Number of bootstrapping iterations to perform when estimating prediction </span>
<span class="sd">        intervals.</span>
<span class="sd">    use_in_sample_residuals : bool, default True</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create predictions. </span>
<span class="sd">        If `False`, out of sample residuals (calibration) are used. </span>
<span class="sd">        Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<span class="sd">        `set_out_sample_residuals()` method.</span>
<span class="sd">    use_binned_residuals : bool, default True</span>
<span class="sd">        If `True`, residuals are selected based on the predicted values </span>
<span class="sd">        (binned selection).</span>
<span class="sd">        If `False`, residuals are selected randomly.</span>
<span class="sd">    random_state : int, default 123</span>
<span class="sd">        Seed for the random number generator to ensure reproducibility.</span>
<span class="sd">    return_predictors : bool, default False</span>
<span class="sd">        If `True`, the predictors used to make the predictions are also returned.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default False</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the backtesting </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metrics_levels : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s). Index are the levels and columns the metrics.</span>
<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Long-format DataFrame containing the predicted values for each series. The </span>
<span class="sd">        DataFrame includes the following columns:</span>

<span class="sd">        - `level`: Identifier for the time series or level being predicted.</span>
<span class="sd">        - `pred`: Predicted values for the corresponding series and time steps.</span>

<span class="sd">        If `interval` is not `None`, additional columns are included depending on the method:</span>

<span class="sd">        - For `float`: Columns `lower_bound` and `upper_bound`.</span>
<span class="sd">        - For `list` or `tuple` of 2 elements: Columns `lower_bound` and `upper_bound`.</span>
<span class="sd">        - For `list` or `tuple` with multiple percentiles: One column per percentile </span>
<span class="sd">        (e.g., `p_10`, `p_50`, `p_90`).</span>
<span class="sd">        - For `&#39;bootstrapping&#39;`: One column per bootstrapping iteration </span>
<span class="sd">        (e.g., `pred_boot_0`, `pred_boot_1`, ..., `pred_boot_n`).</span>
<span class="sd">        - For `scipy.stats` distribution objects: One column for each estimated </span>
<span class="sd">        parameter of the distribution (e.g., `loc`, `scale`).</span>

<span class="sd">        If `return_predictors` is `True`:</span>

<span class="sd">        - fold: Indicates the fold number where the prediction was made.</span>
<span class="sd">        - One column per predictor is created.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<span class="sd">           https://otexts.com/fpp3/prediction-intervals.html</span>

<span class="sd">    .. [2] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<span class="sd">           https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">multi_series_forecasters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ForecasterRecursiveMultiSeries&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ForecasterDirectMultiVariate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterRnn&#39;</span>
    <span class="p">]</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">multi_series_forecasters</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`forecaster` must be of type </span><span class="si">{</span><span class="n">multi_series_forecasters</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;for all other types of forecasters use the functions available in &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;the `model_selection` module. Got </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterRecursiveMultiSeries&#39;</span><span class="p">:</span>
        <span class="n">series</span><span class="p">,</span> <span class="n">series_indexes</span> <span class="o">=</span> <span class="n">check_preprocess_series</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">series_names_in_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">exog_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span><span class="p">}</span>
            <span class="n">exog</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">check_preprocess_exog_multiseries</span><span class="p">(</span>
                          <span class="n">series_names_in_</span>  <span class="o">=</span> <span class="n">series_names_in_</span><span class="p">,</span>
                          <span class="n">series_index_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">series_indexes</span><span class="p">[</span><span class="n">series_names_in_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span>
                          <span class="n">exog</span>              <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                          <span class="n">exog_dict</span>         <span class="o">=</span> <span class="n">exog_dict</span>
                      <span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>              <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">cv</span>                      <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">metric</span>                  <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">add_aggregated_metric</span>   <span class="o">=</span> <span class="n">add_aggregated_metric</span><span class="p">,</span>
        <span class="n">series</span>                  <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
        <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">interval</span>                <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">interval_method</span>         <span class="o">=</span> <span class="n">interval_method</span><span class="p">,</span>
        <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
        <span class="n">use_binned_residuals</span>    <span class="o">=</span> <span class="n">use_binned_residuals</span><span class="p">,</span>
        <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">return_predictors</span>       <span class="o">=</span> <span class="n">return_predictors</span><span class="p">,</span>
        <span class="n">n_jobs</span>                  <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">show_progress</span>           <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">suppress_warnings</span>       <span class="o">=</span> <span class="n">suppress_warnings</span>
    <span class="p">)</span>

    <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster_multiseries</span><span class="p">(</span>
        <span class="n">forecaster</span>              <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">series</span>                  <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
        <span class="n">cv</span>                      <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">levels</span>                  <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
        <span class="n">metric</span>                  <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">add_aggregated_metric</span>   <span class="o">=</span> <span class="n">add_aggregated_metric</span><span class="p">,</span>
        <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">interval</span>                <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">interval_method</span>         <span class="o">=</span> <span class="n">interval_method</span><span class="p">,</span>
        <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
        <span class="n">use_binned_residuals</span>    <span class="o">=</span> <span class="n">use_binned_residuals</span><span class="p">,</span>
        <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
        <span class="n">return_predictors</span>       <span class="o">=</span> <span class="n">return_predictors</span><span class="p">,</span>
        <span class="n">n_jobs</span>                  <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>                 <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">show_progress</span>           <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">suppress_warnings</span>       <span class="o">=</span> <span class="n">suppress_warnings</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">metrics_levels</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.grid_search_forecaster_multiseries" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._search.grid_search_forecaster_multiseries</span>


<a href="#skforecast.model_selection._search.grid_search_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">grid_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">aggregate_metric</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;weighted_average&quot;</span><span class="p">,</span>
        <span class="s2">&quot;average&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pooling&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Exhaustive search over specified parameter values for a Forecaster object.
Validation is done using multi-series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursiveMultiSeries">ForecasterRecursiveMultiSeries</span>, <span title="ForecasterDirectMultiVariate">ForecasterDirectMultiVariate</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_grid</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aggregate_metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation method/s used to combine the metric/s of all levels (series)
when multiple levels are predicted. If list, the first aggregation method
is used to select the best parameters.</p>
<ul>
<li>'average': the average (arithmetic mean) of all levels.</li>
<li>'weighted_average': the average of the metrics weighted by the number of
predicted values of each level.</li>
<li>'pooling': the values of all levels are pooled and then the metric is
calculated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags_grid</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the hyperparameter 
search. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column levels: levels configuration for each iteration.</li>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration. The resulting 
metric will be the average of the optimization of all levels.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">grid_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">aggregate_metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span>
    <span class="n">levels</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
        <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a Forecaster object.</span>
<span class="sd">    Validation is done using multi-series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    aggregate_metric : str, list, default `[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</span>
<span class="sd">        Aggregation method/s used to combine the metric/s of all levels (series)</span>
<span class="sd">        when multiple levels are predicted. If list, the first aggregation method</span>
<span class="sd">        is used to select the best parameters.</span>

<span class="sd">        - &#39;average&#39;: the average (arithmetic mean) of all levels.</span>
<span class="sd">        - &#39;weighted_average&#39;: the average of the metrics weighted by the number of</span>
<span class="sd">        predicted values of each level.</span>
<span class="sd">        - &#39;pooling&#39;: the values of all levels are pooled and then the metric is</span>
<span class="sd">        calculated.</span>
<span class="sd">    levels : str, list, default None</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default None</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    lags_grid : list, dict, default None</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>
<span class="sd">    return_best : bool, default True</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default False</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the hyperparameter </span>
<span class="sd">        search. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    output_file : str, default None</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column levels: levels configuration for each iteration.</span>
<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration. The resulting </span>
<span class="sd">        metric will be the average of the optimization of all levels.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_multiseries</span><span class="p">(</span>
                  <span class="n">forecaster</span>        <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                  <span class="n">series</span>            <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                  <span class="n">cv</span>                <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                  <span class="n">param_grid</span>        <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                  <span class="n">metric</span>            <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                  <span class="n">aggregate_metric</span>  <span class="o">=</span> <span class="n">aggregate_metric</span><span class="p">,</span>
                  <span class="n">levels</span>            <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                  <span class="n">exog</span>              <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                  <span class="n">lags_grid</span>         <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                  <span class="n">n_jobs</span>            <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                  <span class="n">return_best</span>       <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                  <span class="n">verbose</span>           <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                  <span class="n">show_progress</span>     <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                  <span class="n">suppress_warnings</span> <span class="o">=</span> <span class="n">suppress_warnings</span><span class="p">,</span>
                  <span class="n">output_file</span>       <span class="o">=</span> <span class="n">output_file</span>
              <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.random_search_forecaster_multiseries" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._search.random_search_forecaster_multiseries</span>


<a href="#skforecast.model_selection._search.random_search_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">random_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">aggregate_metric</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;weighted_average&quot;</span><span class="p">,</span>
        <span class="s2">&quot;average&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pooling&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using multi-series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursiveMultiSeries">ForecasterRecursiveMultiSeries</span>, <span title="ForecasterDirectMultiVariate">ForecasterDirectMultiVariate</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a>, <a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold or OneStepAheadFold object with the information needed to split
the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_distributions</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and distributions or 
lists of parameters to try.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aggregate_metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation method/s used to combine the metric/s of all levels (series)
when multiple levels are predicted. If list, the first aggregation method
is used to select the best parameters.</p>
<ul>
<li>'average': the average (arithmetic mean) of all levels.</li>
<li>'weighted_average': the average of the metrics weighted by the number of
predicted values of each level.</li>
<li>'pooling': the values of all levels are pooled and then the metric is
calculated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags_grid</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_iter</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled per lags configuration. 
n_iter trades off runtime vs quality of the solution.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the hyperparameter 
search. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column levels: levels configuration for each iteration.</li>
<li>column lags: lags configuration for each iteration.</li>
<li>column lags_label: descriptive label or alias for the lags.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration. The resulting 
metric will be the average of the optimization of all levels.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">aggregate_metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span>
    <span class="n">levels</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lags_grid</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
        <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using multi-series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold, OneStepAheadFold</span>
<span class="sd">        TimeSeriesFold or OneStepAheadFold object with the information needed to split</span>
<span class="sd">        the data into folds.</span>
<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and distributions or </span>
<span class="sd">        lists of parameters to try.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    aggregate_metric : str, list, default `[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</span>
<span class="sd">        Aggregation method/s used to combine the metric/s of all levels (series)</span>
<span class="sd">        when multiple levels are predicted. If list, the first aggregation method</span>
<span class="sd">        is used to select the best parameters.</span>

<span class="sd">        - &#39;average&#39;: the average (arithmetic mean) of all levels.</span>
<span class="sd">        - &#39;weighted_average&#39;: the average of the metrics weighted by the number of</span>
<span class="sd">        predicted values of each level.</span>
<span class="sd">        - &#39;pooling&#39;: the values of all levels are pooled and then the metric is</span>
<span class="sd">        calculated.</span>
<span class="sd">    levels : str, list, default None</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default None</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    lags_grid : list, dict, default None</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>
<span class="sd">    n_iter : int, default 10</span>
<span class="sd">        Number of parameter settings that are sampled per lags configuration. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>
<span class="sd">    random_state : int, default 123</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default True</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default False</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the hyperparameter </span>
<span class="sd">        search. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    output_file : str, default None</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column levels: levels configuration for each iteration.</span>
<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column lags_label: descriptive label or alias for the lags.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration. The resulting </span>
<span class="sd">        metric will be the average of the optimization of all levels.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_multiseries</span><span class="p">(</span>
                  <span class="n">forecaster</span>        <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                  <span class="n">series</span>            <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                  <span class="n">cv</span>                <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                  <span class="n">param_grid</span>        <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
                  <span class="n">metric</span>            <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                  <span class="n">aggregate_metric</span>  <span class="o">=</span> <span class="n">aggregate_metric</span><span class="p">,</span>
                  <span class="n">levels</span>            <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                  <span class="n">exog</span>              <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                  <span class="n">lags_grid</span>         <span class="o">=</span> <span class="n">lags_grid</span><span class="p">,</span>
                  <span class="n">return_best</span>       <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                  <span class="n">n_jobs</span>            <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                  <span class="n">verbose</span>           <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                  <span class="n">show_progress</span>     <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                  <span class="n">suppress_warnings</span> <span class="o">=</span> <span class="n">suppress_warnings</span><span class="p">,</span>
                  <span class="n">output_file</span>       <span class="o">=</span> <span class="n">output_file</span>
              <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.bayesian_search_forecaster_multiseries" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._search.bayesian_search_forecaster_multiseries</span>


<a href="#skforecast.model_selection._search.bayesian_search_forecaster_multiseries" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">bayesian_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">search_space</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">aggregate_metric</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;weighted_average&quot;</span><span class="p">,</span>
        <span class="s2">&quot;average&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pooling&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kwargs_create_study</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">kwargs_study_optimize</span><span class="o">=</span><span class="p">{},</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Bayesian search for hyperparameters of a Forecaster object using optuna library.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursiveMultiSeries">ForecasterRecursiveMultiSeries</span>, <span title="ForecasterDirectMultiVariate">ForecasterDirectMultiVariate</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>search_space</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function with argument <code>trial</code> which returns a dictionary with parameters names 
(<code>str</code>) as keys and Trial object from optuna (trial.suggest_float, 
trial.suggest_int, trial.suggest_categorical) as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aggregate_metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation method/s used to combine the metric/s of all levels (series)
when multiple levels are predicted. If list, the first aggregation method
is used to select the best parameters.</p>
<ul>
<li>'average': the average (arithmetic mean) of all levels.</li>
<li>'weighted_average': the average of the metrics weighted by the number of
predicted values of each level.</li>
<li>'pooling': the values of all levels are pooled and then the metric is
calculated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>level (<code>str</code>) or levels (<code>list</code>) at which the forecaster is optimized. 
If <code>None</code>, all levels are taken into account.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_trials</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled in each lag configuration.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the hyperparameter
search. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs_create_study</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments (key, value mappings) to pass to optuna.create_study().
If default, the direction is set to 'minimize' and a TPESampler(seed=123) 
sampler is used during optimization.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs_study_optimize</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments (key, value mappings) to pass to study.optimize().</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column levels: levels configuration for each iteration.</li>
<li>column lags: lags configuration for each iteration.</li>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration. The resulting 
metric will be the average of the optimization of all levels.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>best_trial</code></td>            <td>
                  <code>optuna object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The best optimization result returned as a FrozenTrial optuna object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bayesian_search_forecaster_multiseries</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
    <span class="n">search_space</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">aggregate_metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weighted_average&#39;</span><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="s1">&#39;pooling&#39;</span><span class="p">],</span>
    <span class="n">levels</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kwargs_create_study</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">kwargs_study_optimize</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian search for hyperparameters of a Forecaster object using optuna library.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    search_space : Callable</span>
<span class="sd">        Function with argument `trial` which returns a dictionary with parameters names </span>
<span class="sd">        (`str`) as keys and Trial object from optuna (trial.suggest_float, </span>
<span class="sd">        trial.suggest_int, trial.suggest_categorical) as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    aggregate_metric : str, list, default `[&#39;weighted_average&#39;, &#39;average&#39;, &#39;pooling&#39;]`</span>
<span class="sd">        Aggregation method/s used to combine the metric/s of all levels (series)</span>
<span class="sd">        when multiple levels are predicted. If list, the first aggregation method</span>
<span class="sd">        is used to select the best parameters.</span>

<span class="sd">        - &#39;average&#39;: the average (arithmetic mean) of all levels.</span>
<span class="sd">        - &#39;weighted_average&#39;: the average of the metrics weighted by the number of</span>
<span class="sd">        predicted values of each level.</span>
<span class="sd">        - &#39;pooling&#39;: the values of all levels are pooled and then the metric is</span>
<span class="sd">        calculated.</span>
<span class="sd">    levels : str, list, default None</span>
<span class="sd">        level (`str`) or levels (`list`) at which the forecaster is optimized. </span>
<span class="sd">        If `None`, all levels are taken into account.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default None</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    n_trials : int, default 10</span>
<span class="sd">        Number of parameter settings that are sampled in each lag configuration.</span>
<span class="sd">    random_state : int, default 123</span>
<span class="sd">        Sets a seed to the sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default True</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default False</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the hyperparameter</span>
<span class="sd">        search. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    output_file : str, default None</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>
<span class="sd">    kwargs_create_study : dict, default {}</span>
<span class="sd">        Additional keyword arguments (key, value mappings) to pass to optuna.create_study().</span>
<span class="sd">        If default, the direction is set to &#39;minimize&#39; and a TPESampler(seed=123) </span>
<span class="sd">        sampler is used during optimization.</span>
<span class="sd">    kwargs_study_optimize : dict, default {}</span>
<span class="sd">        Additional keyword arguments (key, value mappings) to pass to study.optimize().</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column levels: levels configuration for each iteration.</span>
<span class="sd">        - column lags: lags configuration for each iteration.</span>
<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration. The resulting </span>
<span class="sd">        metric will be the average of the optimization of all levels.</span>
<span class="sd">        - additional n columns with param = value.</span>
<span class="sd">    best_trial : optuna object</span>
<span class="sd">        The best optimization result returned as a FrozenTrial optuna object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span> <span class="o">=</span> <span class="n">_bayesian_search_optuna_multiseries</span><span class="p">(</span>
                              <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
                              <span class="n">series</span>                <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                              <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
                              <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                              <span class="n">levels</span>                <span class="o">=</span> <span class="n">levels</span><span class="p">,</span> 
                              <span class="n">search_space</span>          <span class="o">=</span> <span class="n">search_space</span><span class="p">,</span>
                              <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
                              <span class="n">aggregate_metric</span>      <span class="o">=</span> <span class="n">aggregate_metric</span><span class="p">,</span>
                              <span class="n">n_trials</span>              <span class="o">=</span> <span class="n">n_trials</span><span class="p">,</span>
                              <span class="n">random_state</span>          <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                              <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
                              <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                              <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
                              <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
                              <span class="n">suppress_warnings</span>     <span class="o">=</span> <span class="n">suppress_warnings</span><span class="p">,</span>
                              <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span><span class="p">,</span>
                              <span class="n">kwargs_create_study</span>   <span class="o">=</span> <span class="n">kwargs_create_study</span><span class="p">,</span>
                              <span class="n">kwargs_study_optimize</span> <span class="o">=</span> <span class="n">kwargs_study_optimize</span>
                          <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._validation.backtesting_sarimax" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._validation.backtesting_sarimax</span>


<a href="#skforecast.model_selection._validation.backtesting_sarimax" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">backtesting_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Backtesting of ForecasterSarimax.</p>
<p>A copy of the original forecaster is created so that it is not modified during 
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="ForecasterSarimax">ForecasterSarimax</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The confidence intervals for the forecasts are (1 - alpha) %.
If both, <code>alpha</code> and <code>interval</code> are provided, <code>alpha</code> will be used.</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence of the prediction interval estimated. The values must be
symmetric. Sequence of percentiles to compute, which must be between 
0 and 100 inclusive. For example, interval of 95% should be as 
<code>interval = [2.5, 97.5]</code>. If both, <code>alpha</code> and <code>interval</code> are 
provided, <code>alpha</code> will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and validation sets used 
for backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings_fit</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, warnings generated during fitting will be ignored.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>metric_values</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value(s) of the metric(s).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>backtest_predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted values and their estimated interval if <code>interval</code> is not <code>None</code>.</p>
<ul>
<li>column pred: predictions.</li>
<li>column lower_bound: lower bound of the interval.</li>
<li>column upper_bound: upper bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_validation.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">backtesting_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backtesting of ForecasterSarimax.</span>

<span class="sd">    A copy of the original forecaster is created so that it is not modified during </span>
<span class="sd">    the process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterSarimax</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default None</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    alpha : float, default 0.05</span>
<span class="sd">        The confidence intervals for the forecasts are (1 - alpha) %.</span>
<span class="sd">        If both, `alpha` and `interval` are provided, `alpha` will be used.</span>
<span class="sd">    interval : list, tuple, default None</span>
<span class="sd">        Confidence of the prediction interval estimated. The values must be</span>
<span class="sd">        symmetric. Sequence of percentiles to compute, which must be between </span>
<span class="sd">        0 and 100 inclusive. For example, interval of 95% should be as </span>
<span class="sd">        `interval = [2.5, 97.5]`. If both, `alpha` and `interval` are </span>
<span class="sd">        provided, `alpha` will be used.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting. </span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds and index of training and validation sets used </span>
<span class="sd">        for backtesting.</span>
<span class="sd">    suppress_warnings_fit : bool, default False</span>
<span class="sd">        If `True`, warnings generated during fitting will be ignored.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    metric_values : pandas DataFrame</span>
<span class="sd">        Value(s) of the metric(s).</span>
<span class="sd">    backtest_predictions : pandas DataFrame</span>
<span class="sd">        Predicted values and their estimated interval if `interval` is not `None`.</span>

<span class="sd">        - column pred: predictions.</span>
<span class="sd">        - column lower_bound: lower bound of the interval.</span>
<span class="sd">        - column upper_bound: upper bound of the interval.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;`forecaster` must be of type `ForecasterSarimax`, for all other &quot;</span>
            <span class="s2">&quot;types of forecasters use the functions available in the other &quot;</span>
            <span class="s2">&quot;`model_selection` modules.&quot;</span>
        <span class="p">)</span>

    <span class="n">check_backtesting_input</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">alpha</span>                 <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">suppress_warnings_fit</span> <span class="o">=</span> <span class="n">suppress_warnings_fit</span>
    <span class="p">)</span>

    <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_sarimax</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">alpha</span>                 <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="n">interval</span>              <span class="o">=</span> <span class="n">interval</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">suppress_warnings_fit</span> <span class="o">=</span> <span class="n">suppress_warnings_fit</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.grid_search_sarimax" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._search.grid_search_sarimax</span>


<a href="#skforecast.model_selection._search.grid_search_sarimax" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">grid_search_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Exhaustive search over specified parameter values for a ForecasterSarimax object.
Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="ForecasterSarimax">ForecasterSarimax</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_grid</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and lists of parameter
settings to try as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings_fit</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, warnings generated during fitting will be ignored.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">grid_search_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exhaustive search over specified parameter values for a ForecasterSarimax object.</span>
<span class="sd">    Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterSarimax</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_grid : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and lists of parameter</span>
<span class="sd">        settings to try as values.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default None</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    return_best : bool, default True</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    suppress_warnings_fit : bool, default False</span>
<span class="sd">        If `True`, warnings generated during fitting will be ignored.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default None</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_sarimax</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">suppress_warnings_fit</span> <span class="o">=</span> <span class="n">suppress_warnings_fit</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._search.random_search_sarimax" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._search.random_search_sarimax</span>


<a href="#skforecast.model_selection._search.random_search_sarimax" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">random_search_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Random search over specified parameter values or distributions for a Forecaster 
object. Validation is done using time series backtesting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="ForecasterSarimax">ForecasterSarimax</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.
<strong>New in version 0.14.0</strong></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_distributions</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameters names (<code>str</code>) as keys and 
distributions or lists of parameters to try.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
<ul>
<li>If <code>string</code>: {'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
(Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Must have the same
number of observations as <code>y</code> and should be aligned so that y[i] is
regressed on exog[i].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_iter</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings that are sampled. 
n_iter trades off runtime vs quality of the solution.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Refit the <code>forecaster</code> using the best found parameters on the whole data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_backtesting.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds used for cv or backtesting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings_fit</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, warnings generated during fitting will be ignored.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the filename or full path where the results should be saved. 
The results will be saved in a tab-separated values (TSV) format. If 
<code>None</code>, the results will not be saved to a file.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each combination of parameters.</p>
<ul>
<li>column params: parameters configuration for each iteration.</li>
<li>column metric: metric value estimated for each iteration.</li>
<li>additional n columns with param = value.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_search.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">random_search_sarimax</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random search over specified parameter values or distributions for a Forecaster </span>
<span class="sd">    object. Validation is done using time series backtesting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : ForecasterSarimax</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series. </span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">        **New in version 0.14.0**</span>
<span class="sd">    param_distributions : dict</span>
<span class="sd">        Dictionary with parameters names (`str`) as keys and </span>
<span class="sd">        distributions or lists of parameters to try.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>

<span class="sd">        - If `string`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<span class="sd">        &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<span class="sd">        - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<span class="sd">        (Optional) that returns a float.</span>
<span class="sd">        - If `list`: List containing multiple strings and/or Callables.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default None</span>
<span class="sd">        Exogenous variable/s included as predictor/s. Must have the same</span>
<span class="sd">        number of observations as `y` and should be aligned so that y[i] is</span>
<span class="sd">        regressed on exog[i].</span>
<span class="sd">    n_iter : int, default 10</span>
<span class="sd">        Number of parameter settings that are sampled. </span>
<span class="sd">        n_iter trades off runtime vs quality of the solution.</span>
<span class="sd">    random_state : int, default 123</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>
<span class="sd">    return_best : bool, default True</span>
<span class="sd">        Refit the `forecaster` using the best found parameters on the whole data.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default &#39;auto&#39;</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_backtesting.</span>
<span class="sd">    verbose : bool, default False</span>
<span class="sd">        Print number of folds used for cv or backtesting.</span>
<span class="sd">    suppress_warnings_fit : bool, default False</span>
<span class="sd">        If `True`, warnings generated during fitting will be ignored.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    output_file : str, default None</span>
<span class="sd">        Specifies the filename or full path where the results should be saved. </span>
<span class="sd">        The results will be saved in a tab-separated values (TSV) format. If </span>
<span class="sd">        `None`, the results will not be saved to a file.</span>
<span class="sd">        **New in version 0.12.0**</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : pandas DataFrame</span>
<span class="sd">        Results for each combination of parameters.</span>

<span class="sd">        - column params: parameters configuration for each iteration.</span>
<span class="sd">        - column metric: metric value estimated for each iteration.</span>
<span class="sd">        - additional n columns with param = value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters_sarimax</span><span class="p">(</span>
        <span class="n">forecaster</span>            <span class="o">=</span> <span class="n">forecaster</span><span class="p">,</span>
        <span class="n">y</span>                     <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">cv</span>                    <span class="o">=</span> <span class="n">cv</span><span class="p">,</span>
        <span class="n">param_grid</span>            <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>
        <span class="n">metric</span>                <span class="o">=</span> <span class="n">metric</span><span class="p">,</span>
        <span class="n">exog</span>                  <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">return_best</span>           <span class="o">=</span> <span class="n">return_best</span><span class="p">,</span>
        <span class="n">n_jobs</span>                <span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span><span class="p">,</span>
        <span class="n">suppress_warnings_fit</span> <span class="o">=</span> <span class="n">suppress_warnings_fit</span><span class="p">,</span>
        <span class="n">show_progress</span>         <span class="o">=</span> <span class="n">show_progress</span><span class="p">,</span>
        <span class="n">output_file</span>           <span class="o">=</span> <span class="n">output_file</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="skforecast.model_selection._split.BaseFold" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">skforecast.model_selection._split.BaseFold</span>


<a href="#skforecast.model_selection._split.BaseFold" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">BaseFold</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Base class for all Fold classes in skforecast. All fold classes should specify
all the parameters that can be set at the class level in their <code>__init__</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold. This is also commonly
referred to as the forecast horizon or test size.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_train_size</code>
            </td>
            <td>
                  <code>int, str, pandas Timestamp</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
<ul>
<li>If an integer, the number of observations used for initial training.</li>
<li>If a date string or pandas Timestamp, it is the last date included in 
the initial training set.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refit</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
<ul>
<li>If <code>True</code>, the forecaster is refitted in each fold.</li>
<li>If <code>False</code>, the forecaster is trained only in the first fold.</li>
<li>If an integer, the forecaster is trained in the first fold and then refitted
  every <code>refit</code> folds.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fixed_train_size</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gap</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the start of the
test set.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_folds</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
<ul>
<li>If an integer, every 'skip_folds'-th is returned.</li>
<li>If a list, the indexes of the folds to skip.</li>
</ul>
<p>For example, if <code>skip_folds=3</code> and there are 10 folds, the returned folds are
0, 3, 6, and 9. If <code>skip_folds=[1, 2, 3]</code>, the returned folds are 0, 4, 5, 6, 7,
8, and 9.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_incomplete_fold</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer observations than <code>steps</code>.
If <code>False</code>, the last fold is excluded if it is incomplete.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all_indexes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="steps


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.steps)" href="#skforecast.model_selection._split.BaseFold.steps">steps</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold. This is also commonly
referred to as the forecast horizon or test size.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="initial_train_size


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.initial_train_size)" href="#skforecast.model_selection._split.BaseFold.initial_train_size">initial_train_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="window_size


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.window_size)" href="#skforecast.model_selection._split.BaseFold.window_size">window_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="differentiation


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.differentiation)" href="#skforecast.model_selection._split.BaseFold.differentiation">differentiation</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="refit


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.refit)" href="#skforecast.model_selection._split.BaseFold.refit">refit</a></code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="fixed_train_size


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.fixed_train_size)" href="#skforecast.model_selection._split.BaseFold.fixed_train_size">fixed_train_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="gap


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.gap)" href="#skforecast.model_selection._split.BaseFold.gap">gap</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the start of the
test set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="skip_folds


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.skip_folds)" href="#skforecast.model_selection._split.BaseFold.skip_folds">skip_folds</a></code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="allow_incomplete_fold


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.allow_incomplete_fold)" href="#skforecast.model_selection._split.BaseFold.allow_incomplete_fold">allow_incomplete_fold</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer observations than <code>steps</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="return_all_indexes


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.return_all_indexes)" href="#skforecast.model_selection._split.BaseFold.return_all_indexes">return_all_indexes</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="verbose


  
      instance-attribute
   (skforecast.model_selection._split.BaseFold.verbose)" href="#skforecast.model_selection._split.BaseFold.verbose">verbose</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="set_params (skforecast.model_selection._split.BaseFold.set_params)" href="#skforecast.model_selection._split.BaseFold.set_params">set_params</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Set the parameters of the Fold object. Before overwriting the current </p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



                  <details class="quote">
                    <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">(</span>
        <span class="n">cv_name</span>               <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">window_size</span>           <span class="o">=</span> <span class="n">window_size</span><span class="p">,</span>
        <span class="n">differentiation</span>       <span class="o">=</span> <span class="n">differentiation</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">return_all_indexes</span>    <span class="o">=</span> <span class="n">return_all_indexes</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>           <span class="o">=</span> <span class="n">window_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>       <span class="o">=</span> <span class="n">differentiation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span>    <span class="o">=</span> <span class="n">return_all_indexes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.steps" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">steps</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.steps" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.initial_train_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">initial_train_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.initial_train_size" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">initial_train_size</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.window_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">window_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.window_size" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.differentiation" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">differentiation</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.differentiation" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">differentiation</span> <span class="o">=</span> <span class="n">differentiation</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.refit" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">refit</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.refit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">refit</span> <span class="o">=</span> <span class="n">refit</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.fixed_train_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">fixed_train_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.fixed_train_size" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">fixed_train_size</span> <span class="o">=</span> <span class="n">fixed_train_size</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.gap" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">gap</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.gap" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">gap</span> <span class="o">=</span> <span class="n">gap</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.skip_folds" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">skip_folds</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.skip_folds" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">skip_folds</span> <span class="o">=</span> <span class="n">skip_folds</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.allow_incomplete_fold" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">allow_incomplete_fold</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.allow_incomplete_fold" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.return_all_indexes" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">return_all_indexes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.return_all_indexes" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">return_all_indexes</span> <span class="o">=</span> <span class="n">return_all_indexes</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="skforecast.model_selection._split.BaseFold.verbose" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">verbose</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#skforecast.model_selection._split.BaseFold.verbose" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.BaseFold._validate_params" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_validate_params</span>


<a href="#skforecast.model_selection._split.BaseFold._validate_params" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_validate_params</span><span class="p">(</span>
    <span class="n">cv_name</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate all input parameters to ensure correctness.</p>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_validate_params</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">cv_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate all input parameters to ensure correctness.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">==</span> <span class="s2">&quot;TimeSeriesFold&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`steps` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0, a date &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;string, a pandas Timestamp, or None. Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;a date string, a pandas Timestamp, or None. Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`refit` must be a boolean or an integer equal or greater than 0. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">refit</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">refit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`refit` must be a boolean or an integer equal or greater than 0. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">refit</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fixed_train_size</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`fixed_train_size` must be a boolean: `True`, `False`. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gap</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">gap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`gap` must be an integer greater than or equal to 0. Got </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;`skip_folds` must be an integer greater than 0, a list of &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;integers or `None`. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="n">skip_folds</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;`skip_folds` must be an integer greater than 0, a list of &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;integers or `None`. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">([</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">skip_folds</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;`skip_folds` list must contain integers greater than or &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;equal to 1. The first fold is always needed to train the &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;forecaster. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">allow_incomplete_fold</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`allow_incomplete_fold` must be a boolean: `True`, `False`. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">==</span> <span class="s2">&quot;OneStepAheadFold&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0, a date &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;string, or a pandas Timestamp. Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;a date string, or a pandas Timestamp. Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)))</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>
        <span class="ow">and</span> <span class="n">window_size</span> <span class="o">&lt;</span> <span class="mi">1</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`window_size` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_all_indexes</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`return_all_indexes` must be a boolean: `True`, `False`. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">differentiation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">differentiation</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`differentiation` must be None or an integer greater than or &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;equal to 0. Got </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`verbose` must be a boolean: `True`, `False`. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">verbose</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.BaseFold._extract_index" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_extract_index</span>


<a href="#skforecast.model_selection._split.BaseFold._extract_index" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extracts and returns the index from the input data X.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame, pandas Index, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>idx</code></td>            <td>
                  <code>pandas Index</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index extracted from the input data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_extract_index</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts and returns the index from the input data X.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : pandas Series, pandas DataFrame, pandas Index, dict</span>
<span class="sd">        Time series data or index to split.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    idx : pandas Index</span>
<span class="sd">        Index extracted from the input data.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">indexes_freq</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">not_valid_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">min_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">max_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">idx</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
                <span class="n">indexes_freq</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freqstr</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
                <span class="n">indexes_freq</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">not_valid_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

            <span class="n">min_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">max_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">not_valid_index</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;If `X` is a dictionary, all series must have a Pandas &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_index</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">indexes_freq</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;If `X` is a dictionary, all series must have a Pandas &quot;</span>
                <span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
                <span class="s2">&quot;Found series with no frequency or step.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;If `X` is a dictionary, all series must have a Pandas &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Found frequencies: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
                <span class="n">start</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">min_index</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">max_index</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="n">indexes_freq</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
                <span class="n">start</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">min_index</span><span class="p">),</span> <span class="n">stop</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">max_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">indexes_freq</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">return</span> <span class="n">idx</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.BaseFold.set_params" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_params</span>


<a href="#skforecast.model_selection._split.BaseFold.set_params" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the parameters of the Fold object. Before overwriting the current 
parameters, the input parameters are validated to ensure correctness.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with the parameters to set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the parameters of the Fold object. Before overwriting the current </span>
<span class="sd">    parameters, the input parameters are validated to ensure correctness.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params : dict</span>
<span class="sd">        Dictionary with the parameters to set.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`params` must be a dictionary. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">current_params</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
    <span class="n">unknown_params</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">current_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">unknown_params</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unknown parameters: </span><span class="si">{</span><span class="n">unknown_params</span><span class="si">}</span><span class="s2">. They have been ignored.&quot;</span><span class="p">,</span>
            <span class="n">IgnoredArgumentWarning</span>
        <span class="p">)</span>

    <span class="n">filtered_params</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">current_params</span><span class="p">}</span>
    <span class="n">updated_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cv_name&#39;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="o">**</span><span class="n">current_params</span><span class="p">,</span> <span class="o">**</span><span class="n">filtered_params</span><span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">(</span><span class="o">**</span><span class="n">updated_params</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">updated_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="skforecast.model_selection._split.TimeSeriesFold" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">skforecast.model_selection._split.TimeSeriesFold</span>


<a href="#skforecast.model_selection._split.TimeSeriesFold" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">TimeSeriesFold</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.BaseFold" href="#skforecast.model_selection._split.BaseFold">BaseFold</a></code></p>


        <p>Class to split time series data into train and test folds. 
When used within a backtesting or hyperparameter search, the arguments
'initial_train_size', 'window_size' and 'differentiation' are not required
as they are automatically set by the backtesting or hyperparameter search
functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold. This is also commonly
referred to as the forecast horizon or test size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_train_size</code>
            </td>
            <td>
                  <code>int, str, pandas Timestamp</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training. </p>
<ul>
<li>If <code>None</code> or 0, the initial forecaster is not trained in the first fold.</li>
<li>If an integer, the number of observations used for initial training.</li>
<li>If a date string or pandas Timestamp, it is the last date included in 
the initial training set.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refit</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
<ul>
<li>If <code>True</code>, the forecaster is refitted in each fold.</li>
<li>If <code>False</code>, the forecaster is trained only in the first fold.</li>
<li>If an integer, the forecaster is trained in the first fold and then refitted
  every <code>refit</code> folds.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fixed_train_size</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gap</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the start of the
test set.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_folds</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
<ul>
<li>If an integer, every 'skip_folds'-th is returned.</li>
<li>If a list, the indexes of the folds to skip.</li>
</ul>
<p>For example, if <code>skip_folds=3</code> and there are 10 folds, the returned folds are
0, 3, 6, and 9. If <code>skip_folds=[1, 2, 3]</code>, the returned folds are 0, 4, 5, 6, 7,
8, and 9.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_incomplete_fold</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer observations than <code>steps</code>.
If <code>False</code>, the last fold is excluded if it is incomplete.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all_indexes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="steps


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.steps)" href="#skforecast.model_selection._split.BaseFold.steps">steps</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold. This is also commonly
referred to as the forecast horizon or test size.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="initial_train_size


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.initial_train_size)" href="#skforecast.model_selection._split.BaseFold.initial_train_size">initial_train_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training. If <code>None</code> or 0, the initial
forecaster is not trained in the first fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="window_size


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.window_size)" href="#skforecast.model_selection._split.BaseFold.window_size">window_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="differentiation


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.differentiation)" href="#skforecast.model_selection._split.BaseFold.differentiation">differentiation</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="refit


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.refit)" href="#skforecast.model_selection._split.BaseFold.refit">refit</a></code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="fixed_train_size


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.fixed_train_size)" href="#skforecast.model_selection._split.BaseFold.fixed_train_size">fixed_train_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="gap


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.gap)" href="#skforecast.model_selection._split.BaseFold.gap">gap</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the start of the
test set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="skip_folds


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.skip_folds)" href="#skforecast.model_selection._split.BaseFold.skip_folds">skip_folds</a></code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="allow_incomplete_fold


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.allow_incomplete_fold)" href="#skforecast.model_selection._split.BaseFold.allow_incomplete_fold">allow_incomplete_fold</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer observations than <code>steps</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="return_all_indexes


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.return_all_indexes)" href="#skforecast.model_selection._split.BaseFold.return_all_indexes">return_all_indexes</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="verbose


  
      instance-attribute
   (skforecast.model_selection._split.TimeSeriesFold.verbose)" href="#skforecast.model_selection._split.BaseFold.verbose">verbose</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Returned values are the positions of the observations and not the actual values of
the index, so they can be used to slice the data directly using iloc. For example,
if the input series is <code>X = [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</code>, the 
<code>initial_train_size = 3</code>, <code>window_size = 2</code>, <code>steps = 4</code>, and <code>gap = 1</code>,
the output of the first fold will: [[0, 3], [1, 3], [3, 8], [4, 8], True].</p>
<p>The first list <code>[0, 3]</code> indicates that the training set goes from the first to the
third observation. The second list <code>[1, 3]</code> indicates that the last window seen by
the forecaster during training goes from the second to the third observation. The
third list <code>[3, 8]</code> indicates that the test set goes from the fourth to the eighth
observation. The fourth list <code>[4, 8]</code> indicates that the test set including the gap
goes from the fifth to the eighth observation. The boolean <code>False</code> indicates that the
forecaster should not be trained in this fold.</p>
<p>Following the python convention, the start index is inclusive and the end index is
exclusive. This means that the last index is not included in the slice.</p>
</details>









<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="split (skforecast.model_selection._split.TimeSeriesFold.split)" href="#skforecast.model_selection._split.TimeSeriesFold.split">split</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Split the time series data into train and test folds.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



                  <details class="quote">
                    <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">skip_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">steps</span>                 <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">initial_train_size</span>    <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">window_size</span>           <span class="o">=</span> <span class="n">window_size</span><span class="p">,</span>
        <span class="n">differentiation</span>       <span class="o">=</span> <span class="n">differentiation</span><span class="p">,</span>
        <span class="n">refit</span>                 <span class="o">=</span> <span class="n">refit</span><span class="p">,</span>
        <span class="n">fixed_train_size</span>      <span class="o">=</span> <span class="n">fixed_train_size</span><span class="p">,</span>
        <span class="n">gap</span>                   <span class="o">=</span> <span class="n">gap</span><span class="p">,</span>
        <span class="n">skip_folds</span>            <span class="o">=</span> <span class="n">skip_folds</span><span class="p">,</span>
        <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span><span class="p">,</span>
        <span class="n">return_all_indexes</span>    <span class="o">=</span> <span class="n">return_all_indexes</span><span class="p">,</span>
        <span class="n">verbose</span>               <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.TimeSeriesFold._repr_html_" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_repr_html_</span>


<a href="#skforecast.model_selection._split.TimeSeriesFold._repr_html_" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_repr_html_</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>HTML representation of the object.
The "General Information" section is expanded by default.</p>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    HTML representation of the object.</span>
<span class="sd">    The &quot;General Information&quot; section is expanded by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">()</span>
    <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<span class="s2">        &lt;h2&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/h2&gt;</span>
<span class="s2">        &lt;details open&gt;</span>
<span class="s2">            &lt;summary&gt;General Information&lt;/summary&gt;</span>
<span class="s2">            &lt;ul&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Initial train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Steps:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Differentiation:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Refit:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Fixed train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Gap:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Skip folds:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Allow incomplete fold:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Return all indexes:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">            &lt;/ul&gt;</span>
<span class="s2">        &lt;/details&gt;</span>
<span class="s2">        &lt;p&gt;</span>
<span class="s2">            &lt;a href=&quot;https://skforecast.org/</span><span class="si">{</span><span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">/api/model_selection.html#skforecast.model_selection._split.TimeSeriesFold&quot;&gt;&amp;#128712 &lt;strong&gt;API Reference&lt;/strong&gt;&lt;/a&gt;</span>
<span class="s2">            &amp;nbsp;&amp;nbsp;</span>
<span class="s2">            &lt;a href=&quot;https://skforecast.org/</span><span class="si">{</span><span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">/user_guides/backtesting.html#timeseriesfold&quot;&gt;&amp;#128462 &lt;strong&gt;User Guide&lt;/strong&gt;&lt;/a&gt;</span>
<span class="s2">        &lt;/p&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.TimeSeriesFold.split" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">split</span>


<a href="#skforecast.model_selection._split.TimeSeriesFold.split" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Split the time series data into train and test folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame, pandas Index, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>as_pandas</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the folds are returned as a DataFrame. This is useful to visualize
the folds in a more interpretable way.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>folds</code></td>            <td>
                  <code>list, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lists containing the indices (position) for each fold. Each list
contains 4 lists and a boolean with the following information:</p>
<ul>
<li>[train_start, train_end]: list with the start and end positions of the
training set.</li>
<li>[last_window_start, last_window_end]: list with the start and end positions
of the last window seen by the forecaster during training. The last window
is used to generate the lags use as predictors. If <code>differentiation</code> is
included, the interval is extended as many observations as the
differentiation order. If the argument <code>window_size</code> is <code>None</code>, this list is
empty.</li>
<li>[test_start, test_end]: list with the start and end positions of the test
set. These are the observations used to evaluate the forecaster.</li>
<li>[test_start_with_gap, test_end_with_gap]: list with the start and end
positions of the test set including the gap. The gap is the number of
observations between the end of the training set and the start of the test
set.</li>
<li>fit_forecaster: boolean indicating whether the forecaster should be fitted
in this fold.</li>
</ul>
<p>It is important to note that the returned values are the positions of the
observations and not the actual values of the index, so they can be used to
slice the data directly using iloc.</p>
<p>If <code>as_pandas</code> is <code>True</code>, the folds are returned as a DataFrame with the
following columns: 'fold', 'train_start', 'train_end', 'last_window_start',
'last_window_end', 'test_start', 'test_end', 'test_start_with_gap',
'test_end_with_gap', 'fit_forecaster'.</p>
<p>Following the python convention, the start index is inclusive and the end
index is exclusive. This means that the last index is not included in the
slice.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split the time series data into train and test folds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : pandas Series, pandas DataFrame, pandas Index, dict</span>
<span class="sd">        Time series data or index to split.</span>
<span class="sd">    as_pandas : bool, default False</span>
<span class="sd">        If True, the folds are returned as a DataFrame. This is useful to visualize</span>
<span class="sd">        the folds in a more interpretable way.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    folds : list, pandas DataFrame</span>
<span class="sd">        A list of lists containing the indices (position) for each fold. Each list</span>
<span class="sd">        contains 4 lists and a boolean with the following information:</span>

<span class="sd">        - [train_start, train_end]: list with the start and end positions of the</span>
<span class="sd">        training set.</span>
<span class="sd">        - [last_window_start, last_window_end]: list with the start and end positions</span>
<span class="sd">        of the last window seen by the forecaster during training. The last window</span>
<span class="sd">        is used to generate the lags use as predictors. If `differentiation` is</span>
<span class="sd">        included, the interval is extended as many observations as the</span>
<span class="sd">        differentiation order. If the argument `window_size` is `None`, this list is</span>
<span class="sd">        empty.</span>
<span class="sd">        - [test_start, test_end]: list with the start and end positions of the test</span>
<span class="sd">        set. These are the observations used to evaluate the forecaster.</span>
<span class="sd">        - [test_start_with_gap, test_end_with_gap]: list with the start and end</span>
<span class="sd">        positions of the test set including the gap. The gap is the number of</span>
<span class="sd">        observations between the end of the training set and the start of the test</span>
<span class="sd">        set.</span>
<span class="sd">        - fit_forecaster: boolean indicating whether the forecaster should be fitted</span>
<span class="sd">        in this fold.</span>

<span class="sd">        It is important to note that the returned values are the positions of the</span>
<span class="sd">        observations and not the actual values of the index, so they can be used to</span>
<span class="sd">        slice the data directly using iloc.</span>

<span class="sd">        If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<span class="sd">        following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;,</span>
<span class="sd">        &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;,</span>
<span class="sd">        &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;.</span>

<span class="sd">        Following the python convention, the start index is inclusive and the end</span>
<span class="sd">        index is exclusive. This means that the last index is not included in the</span>
<span class="sd">        slice.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">window_size_as_date_offset</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
        <span class="c1"># Calculate the window_size in steps. This is not a exact calculation</span>
        <span class="c1"># because the offset follows the calendar rules and the distance between</span>
        <span class="c1"># two dates may not be constant.</span>
        <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">window_size_idx_start</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">first_valid_index</span><span class="p">)</span>
            <span class="n">window_size_idx_end</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size_idx_end</span> <span class="o">-</span> <span class="n">window_size_idx_start</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The length of `y` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">), must be greater than or equal &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;to the window size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">). This is because  &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;the offset (forecaster.offset) is larger than the available &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (forecaster.offset), &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (forecaster.n_offsets) or increase the &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;size of `y`.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;To use split method when `initial_train_size` is None, &quot;</span>
                <span class="s2">&quot;`window_size` must be an integer greater than 0. &quot;</span>
                <span class="s2">&quot;Although no initial training is done and all data is used to &quot;</span>
                <span class="s2">&quot;evaluate the model, the first `window_size` observations are &quot;</span>
                <span class="s2">&quot;needed to create the initial predictors. Got `window_size` = None.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`. &quot;</span>
                <span class="s2">&quot;Set `refit` to `False` if you want to use `initial_train_size = None`.&quot;</span>
            <span class="p">)</span>
        <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>  <span class="c1"># Reset to None later</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Last window cannot be calculated because `window_size` is None.&quot;</span><span class="p">,</span>
                <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
        <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
    <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">last_fold_excluded</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
                                  <span class="n">index</span>        <span class="o">=</span> <span class="n">index</span><span class="p">,</span> 
                                  <span class="n">date_input</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span> 
                                  <span class="n">method</span>       <span class="o">=</span> <span class="s1">&#39;validation&#39;</span><span class="p">,</span>
                                  <span class="n">date_literal</span> <span class="o">=</span> <span class="s1">&#39;initial_train_size&#39;</span>
                              <span class="p">)</span>

    <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;and smaller than the length of the series (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">). If &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The time series must have at least `initial_train_size + steps` &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;observations. Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2"> observations.&quot;</span>
        <span class="p">)</span>

    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
            <span class="c1"># If `fixed_train_size` the train size doesn&#39;t increase but moves by </span>
            <span class="c1"># `steps` positions in each iteration. If `False`, the train size</span>
            <span class="c1"># increases by `steps` in each iteration.</span>
            <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span>
            <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="n">train_iloc_end</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The train size doesn&#39;t increase and doesn&#39;t move.</span>
            <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span>
            <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">last_window_iloc_start</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
        <span class="n">test_iloc_end</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>

        <span class="n">partitions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">idx</span><span class="p">[</span><span class="n">train_iloc_start</span> <span class="p">:</span> <span class="n">train_iloc_end</span><span class="p">],</span>
            <span class="n">idx</span><span class="p">[</span><span class="n">last_window_iloc_start</span> <span class="p">:</span> <span class="n">test_iloc_start</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
            <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span> <span class="p">:</span> <span class="n">test_iloc_end</span><span class="p">],</span>
            <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="p">:</span> <span class="n">test_iloc_end</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
        <span class="n">folds</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">last_fold_excluded</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Replace partitions inside folds with length 0 with `None`</span>
    <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">partition</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">partition</span> <span class="ow">in</span> <span class="n">fold</span><span class="p">]</span> 
         <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
    <span class="p">]</span>

    <span class="c1"># Create a flag to know whether to train the forecaster</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
        <span class="n">fit_forecaster</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">):</span> 
            <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)):</span> 
        <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">index_to_keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">)</span>
            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)),</span> <span class="n">index_to_keep</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">index_to_skip</span><span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)]</span>        

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span>
            <span class="n">index</span>              <span class="o">=</span> <span class="n">index</span><span class="p">,</span>
            <span class="n">folds</span>              <span class="o">=</span> <span class="n">folds</span><span class="p">,</span>
            <span class="n">externally_fitted</span>  <span class="o">=</span> <span class="n">externally_fitted</span><span class="p">,</span>
            <span class="n">last_fold_excluded</span> <span class="o">=</span> <span class="n">last_fold_excluded</span><span class="p">,</span>
            <span class="n">index_to_skip</span>      <span class="o">=</span> <span class="n">index_to_skip</span>
        <span class="p">)</span>

    <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span><span class="n">fold</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index_to_skip</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
        <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
        <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> 
             <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
             <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
             <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
             <span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span> 
            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">folds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">:</span>
                <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
            <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">],</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s1">&#39;train_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;train_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;last_window_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;last_window_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_start_with_gap&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_end_with_gap&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;fit_forecaster&#39;</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">folds</span><span class="p">,</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s1">&#39;train_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;last_window_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_index_with_gap&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;fit_forecaster&#39;</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="n">folds</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fold&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">folds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.TimeSeriesFold._print_info" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_print_info</span>


<a href="#skforecast.model_selection._split.TimeSeriesFold._print_info" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_print_info</span><span class="p">(</span>
    <span class="n">index</span><span class="p">,</span>
    <span class="n">folds</span><span class="p">,</span>
    <span class="n">externally_fitted</span><span class="p">,</span>
    <span class="n">last_fold_excluded</span><span class="p">,</span>
    <span class="n">index_to_skip</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Print information about folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>pandas Index</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the time series data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folds</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lists containing the indices (position) for each fold.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>externally_fitted</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether an already trained forecaster is to be used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_fold_excluded</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the last fold has been excluded because it was incomplete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index_to_skip</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds skipped.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_print_info</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
    <span class="n">folds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
    <span class="n">externally_fitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">last_fold_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">index_to_skip</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print information about folds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : pandas Index</span>
<span class="sd">        Index of the time series data.</span>
<span class="sd">    folds : list</span>
<span class="sd">        A list of lists containing the indices (position) for each fold.</span>
<span class="sd">    externally_fitted : bool</span>
<span class="sd">        Whether an already trained forecaster is to be used.</span>
<span class="sd">    last_fold_excluded : bool</span>
<span class="sd">        Whether the last fold has been excluded because it was incomplete.</span>
<span class="sd">    index_to_skip : list</span>
<span class="sd">        Number of folds skipped.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information of folds&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;An already trained forecaster is to be used. Window size: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of observations used for initial training: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of observations used for initial training: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;    First </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> observation/s in training sets &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;are used for differentiation&quot;</span>
            <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Number of observations used for backtesting: &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Number of folds: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;    Number skipped folds: &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index_to_skip</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">index_to_skip</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">index_to_skip</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Number of steps per fold: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;    Number of steps to exclude between last observed data &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(last window) and predictions (gap): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">last_fold_excluded</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Last fold has been excluded because it was incomplete.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Last fold only includes </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="si">}</span><span class="s2"> observations.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">differentiation</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">differentiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">):</span>
        <span class="n">is_fold_skipped</span>   <span class="o">=</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_to_skip</span>
        <span class="n">has_training</span>      <span class="o">=</span> <span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="n">training_start</span>    <span class="o">=</span> <span class="p">(</span>
            <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">]</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">training_end</span>      <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">training_length</span>   <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">differentiation</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">validation_start</span>  <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">validation_end</span>    <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">validation_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fold: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_fold_skipped</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Fold skipped&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">externally_fitted</span> <span class="ow">and</span> <span class="n">has_training</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;    Training:   </span><span class="si">{</span><span class="n">training_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">training_end</span><span class="si">}</span><span class="s2">  &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">training_length</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;    Validation: </span><span class="si">{</span><span class="n">validation_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">validation_end</span><span class="si">}</span><span class="s2">  &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">validation_length</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Training:   No training in this fold&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;    Validation: </span><span class="si">{</span><span class="n">validation_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">validation_end</span><span class="si">}</span><span class="s2">  &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">validation_length</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="skforecast.model_selection._split.OneStepAheadFold" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">skforecast.model_selection._split.OneStepAheadFold</span>


<a href="#skforecast.model_selection._split.OneStepAheadFold" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">OneStepAheadFold</span><span class="p">(</span>
    <span class="n">initial_train_size</span><span class="p">,</span>
    <span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.BaseFold" href="#skforecast.model_selection._split.BaseFold">BaseFold</a></code></p>


        <p>Class to split time series data into train and test folds for one-step-ahead
forecasting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>initial_train_size</code>
            </td>
            <td>
                  <code>int, str, pandas Timestamp</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
<ul>
<li>If an integer, the number of observations used for initial training.</li>
<li>If a date string or pandas Timestamp, it is the last date included in 
the initial training set.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all_indexes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="initial_train_size


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.initial_train_size)" href="#skforecast.model_selection._split.BaseFold.initial_train_size">initial_train_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="window_size


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.window_size)" href="#skforecast.model_selection._split.BaseFold.window_size">window_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="differentiation


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.differentiation)" href="#skforecast.model_selection._split.BaseFold.differentiation">differentiation</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation. This is used to extend the
<code>last_window</code> as many observations as the differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="return_all_indexes


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.return_all_indexes)" href="#skforecast.model_selection._split.BaseFold.return_all_indexes">return_all_indexes</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="verbose


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.verbose)" href="#skforecast.model_selection._split.BaseFold.verbose">verbose</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="steps


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.steps)" href="#skforecast.model_selection._split.BaseFold.steps">steps</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="fixed_train_size


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.fixed_train_size)" href="#skforecast.model_selection._split.BaseFold.fixed_train_size">fixed_train_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="gap


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.gap)" href="#skforecast.model_selection._split.BaseFold.gap">gap</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="skip_folds


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.skip_folds)" href="#skforecast.model_selection._split.BaseFold.skip_folds">skip_folds</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="allow_incomplete_fold


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.allow_incomplete_fold)" href="#skforecast.model_selection._split.BaseFold.allow_incomplete_fold">allow_incomplete_fold</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="refit


  
      instance-attribute
   (skforecast.model_selection._split.OneStepAheadFold.refit)" href="#skforecast.model_selection._split.BaseFold.refit">refit</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This attribute is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="split (skforecast.model_selection._split.OneStepAheadFold.split)" href="#skforecast.model_selection._split.OneStepAheadFold.split">split</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Split the time series data into train and test folds.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



                  <details class="quote">
                    <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span>
        <span class="n">window_size</span>        <span class="o">=</span> <span class="n">window_size</span><span class="p">,</span>
        <span class="n">differentiation</span>    <span class="o">=</span> <span class="n">differentiation</span><span class="p">,</span>
        <span class="n">return_all_indexes</span> <span class="o">=</span> <span class="n">return_all_indexes</span><span class="p">,</span>
        <span class="n">verbose</span>            <span class="o">=</span> <span class="n">verbose</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.OneStepAheadFold._repr_html_" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_repr_html_</span>


<a href="#skforecast.model_selection._split.OneStepAheadFold._repr_html_" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_repr_html_</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>HTML representation of the object.
The "General Information" section is expanded by default.</p>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    HTML representation of the object.</span>
<span class="sd">    The &quot;General Information&quot; section is expanded by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">()</span>
    <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<span class="s2">        &lt;h2&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/h2&gt;</span>
<span class="s2">        &lt;details open&gt;</span>
<span class="s2">            &lt;summary&gt;General Information&lt;/summary&gt;</span>
<span class="s2">            &lt;ul&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Initial train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Differentiation:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Return all indexes:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">            &lt;/ul&gt;</span>
<span class="s2">        &lt;/details&gt;</span>
<span class="s2">        &lt;p&gt;</span>
<span class="s2">            &lt;a href=&quot;https://skforecast.org/</span><span class="si">{</span><span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">/api/model_selection.html#skforecast.model_selection._split.OneStepAheadFold&quot;&gt;&amp;#128712 &lt;strong&gt;API Reference&lt;/strong&gt;&lt;/a&gt;</span>
<span class="s2">            &amp;nbsp;&amp;nbsp;</span>
<span class="s2">            &lt;a href=&quot;https://skforecast.org/</span><span class="si">{</span><span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">/faq/parameters-search-backtesting-vs-one-step-ahead.html&quot;&gt;&amp;#128462 &lt;strong&gt;User Guide&lt;/strong&gt;&lt;/a&gt;</span>
<span class="s2">        &lt;/p&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.OneStepAheadFold.split" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">split</span>


<a href="#skforecast.model_selection._split.OneStepAheadFold.split" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">externally_fitted</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Split the time series data into train and test folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code>pandas Series, DataFrame, Index, or dictionary</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>as_pandas</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the folds are returned as a DataFrame. This is useful to visualize
the folds in a more interpretable way.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>externally_fitted</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This argument is not used in this class. It is included for API consistency.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>fold</code></td>            <td>
                  <code>list, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lists containing the indices (position) of the fold. The list
contains 2 lists with the following information:</p>
<ul>
<li>[train_start, train_end]: list with the start and end positions of the
training set.</li>
<li>[test_start, test_end]: list with the start and end positions of the test
set. These are the observations used to evaluate the forecaster.</li>
</ul>
<p>It is important to note that the returned values are the positions of the
observations and not the actual values of the index, so they can be used to
slice the data directly using iloc.</p>
<p>If <code>as_pandas</code> is <code>True</code>, the folds are returned as a DataFrame with the
following columns: 'fold', 'train_start', 'train_end', 'test_start', 'test_end'.</p>
<p>Following the python convention, the start index is inclusive and the end
index is exclusive. This means that the last index is not included in the
slice.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">externally_fitted</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split the time series data into train and test folds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : pandas Series, DataFrame, Index, or dictionary</span>
<span class="sd">        Time series data or index to split.</span>
<span class="sd">    as_pandas : bool, default False</span>
<span class="sd">        If True, the folds are returned as a DataFrame. This is useful to visualize</span>
<span class="sd">        the folds in a more interpretable way.</span>
<span class="sd">    externally_fitted : Any</span>
<span class="sd">        This argument is not used in this class. It is included for API consistency.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fold : list, pandas DataFrame</span>
<span class="sd">        A list of lists containing the indices (position) of the fold. The list</span>
<span class="sd">        contains 2 lists with the following information:</span>

<span class="sd">        - [train_start, train_end]: list with the start and end positions of the</span>
<span class="sd">        training set.</span>
<span class="sd">        - [test_start, test_end]: list with the start and end positions of the test</span>
<span class="sd">        set. These are the observations used to evaluate the forecaster.</span>

<span class="sd">        It is important to note that the returned values are the positions of the</span>
<span class="sd">        observations and not the actual values of the index, so they can be used to</span>
<span class="sd">        slice the data directly using iloc.</span>

<span class="sd">        If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<span class="sd">        following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;.</span>

<span class="sd">        Following the python convention, the start index is inclusive and the end</span>
<span class="sd">        index is exclusive. This means that the last index is not included in the</span>
<span class="sd">        slice.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
                                  <span class="n">index</span>        <span class="o">=</span> <span class="n">index</span><span class="p">,</span> 
                                  <span class="n">date_input</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span> 
                                  <span class="n">method</span>       <span class="o">=</span> <span class="s1">&#39;validation&#39;</span><span class="p">,</span>
                                  <span class="n">date_literal</span> <span class="o">=</span> <span class="s1">&#39;initial_train_size&#39;</span>
                              <span class="p">)</span>

    <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
        <span class="kc">True</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">)</span>

    <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
            <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])],</span>
            <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s1">&#39;train_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;train_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_start&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_end&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;fit_forecaster&#39;</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">fold</span><span class="p">],</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s1">&#39;train_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;test_index&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;fit_forecaster&#39;</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="n">fold</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fold&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">fold</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.model_selection._split.OneStepAheadFold._print_info" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_print_info</span>


<a href="#skforecast.model_selection._split.OneStepAheadFold._print_info" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_print_info</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">fold</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Print information about folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>pandas Index</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the time series data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fold</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lists containing the indices (position) of the fold.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_split.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_print_info</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
    <span class="n">fold</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print information about folds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    index : pandas Index</span>
<span class="sd">        Index of the time series data.</span>
<span class="sd">    fold : list</span>
<span class="sd">        A list of lists containing the indices (position) of the fold.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">differentiation</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">differentiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>

    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="n">differentiation</span>
    <span class="n">test_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information of folds&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Number of observations in train: </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;    First </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> observation/s in training set &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;are used for differentiation&quot;</span>
        <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Number of observations in test: </span><span class="si">{</span><span class="n">test_length</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="n">training_start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">]</span>
    <span class="n">training_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">test_start</span>  <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">test_end</span>    <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Training : </span><span class="si">{</span><span class="n">training_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">training_end</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Test     : </span><span class="si">{</span><span class="n">test_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">test_end</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">test_length</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._utils.initialize_lags_grid" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._utils.initialize_lags_grid</span>


<a href="#skforecast.model_selection._utils.initialize_lags_grid" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">initialize_lags_grid</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Initialize lags grid and lags label for model selection. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="Forecaster">Forecaster</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model. ForecasterRecursive, ForecasterDirect, 
ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags_grid</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range 
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code> 
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>lags_grid</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with lags configuration for each iteration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>lags_label</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for lags representation in the results object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initialize_lags_grid</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> 
    <span class="n">lags_grid</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
        <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize lags grid and lags label for model selection. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model. ForecasterRecursive, ForecasterDirect, </span>
<span class="sd">        ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate.</span>
<span class="sd">    lags_grid : list, dict, default None</span>
<span class="sd">        Lists of lags to try, containing int, lists, numpy ndarray, or range </span>
<span class="sd">        objects. If `dict`, the keys are used as labels in the `results` </span>
<span class="sd">        DataFrame, and the values are used as the lists of lags to try.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lags_grid : dict</span>
<span class="sd">        Dictionary with lags configuration for each iteration.</span>
<span class="sd">    lags_label : str</span>
<span class="sd">        Label for lags representation in the results object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`lags_grid` argument must be a list, dict or None. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">lags_label</span> <span class="o">=</span> <span class="s1">&#39;values&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">lags</span> <span class="k">for</span> <span class="n">lags</span> <span class="ow">in</span> <span class="n">lags_grid</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">lags_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">lags</span><span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">lags</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lags_label</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span>

    <span class="k">return</span> <span class="n">lags_grid</span><span class="p">,</span> <span class="n">lags_label</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._utils.check_backtesting_input" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._utils.check_backtesting_input</span>


<a href="#skforecast.model_selection._utils.check_backtesting_input" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">check_backtesting_input</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">add_aggregated_metric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval_method</span><span class="o">=</span><span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">return_predictors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>This is a helper function to check most inputs of backtesting functions in 
modules <code>model_selection</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="Forecaster">Forecaster</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.TimeSeriesFold" href="#skforecast.model_selection._split.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_aggregated_metric</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the aggregated metrics (average, weighted average and pooling)
over all levels are also returned (only multiseries).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for uni-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for multi-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies whether probabilistic predictions should be estimated and the 
method to use. The following options are supported:</p>
<ul>
<li>If <code>float</code>, represents the nominal (expected) coverage (between 0 and 1). 
For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code> percentiles.</li>
<li>If <code>list</code> or <code>tuple</code>: Sequence of percentiles to compute, each value must 
be between 0 and 100 inclusive. For example, a 95% confidence interval can 
be specified as <code>interval = [2.5, 97.5]</code> or multiple percentiles (e.g. 10, 
50 and 90) as <code>interval = [10, 50, 90]</code>.</li>
<li>If 'bootstrapping' (str): <code>n_boot</code> bootstrapping predictions will be generated.</li>
<li>If scipy.stats distribution object, the distribution parameters will
be estimated for each prediction.</li>
<li>If None, no probabilistic predictions are estimated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval_method</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction intervals. Available options:</p>
<ul>
<li>'bootstrapping': Bootstrapping is used to generate prediction 
intervals.</li>
<li>'conformal': Employs the conformal prediction split method for 
interval estimation.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;bootstrapping&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The confidence intervals used in ForecasterSarimax are (1 - alpha) %.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when estimating prediction
    intervals.</p>
              </div>
            </td>
            <td>
                  <code>`250`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of prediction 
error to create prediction intervals.  If <code>False</code>, out_sample_residuals 
are used if they are already stored inside the forecaster.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected based on the predicted values 
(binned selection).
If <code>False</code>, residuals are selected randomly.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to ensure reproducibility.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_predictors</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the predictors used to make the predictions are also returned.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, &#39;auto&#39;)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is 
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
skforecast.utils.select_n_jobs_fit_forecaster.</p>
              </div>
            </td>
            <td>
                  <code>`&#39;auto&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the backtesting 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings_fit</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, warnings generated during fitting will be ignored. Only 
<code>ForecasterSarimax</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_backtesting_input</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">add_aggregated_metric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span>    
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">return_predictors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">suppress_warnings_fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a helper function to check most inputs of backtesting functions in </span>
<span class="sd">    modules `model_selection`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    cv : TimeSeriesFold</span>
<span class="sd">        TimeSeriesFold object with the information needed to split the data into folds.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>
<span class="sd">    add_aggregated_metric : bool, default True</span>
<span class="sd">        If `True`, the aggregated metrics (average, weighted average and pooling)</span>
<span class="sd">        over all levels are also returned (only multiseries).</span>
<span class="sd">    y : pandas Series, default None</span>
<span class="sd">        Training time series for uni-series forecasters.</span>
<span class="sd">    series : pandas DataFrame, dict, default None</span>
<span class="sd">        Training time series for multi-series forecasters.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default None</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    interval : float, list, tuple, str, object, default None</span>
<span class="sd">        Specifies whether probabilistic predictions should be estimated and the </span>
<span class="sd">        method to use. The following options are supported:</span>

<span class="sd">        - If `float`, represents the nominal (expected) coverage (between 0 and 1). </span>
<span class="sd">        For instance, `interval=0.95` corresponds to `[2.5, 97.5]` percentiles.</span>
<span class="sd">        - If `list` or `tuple`: Sequence of percentiles to compute, each value must </span>
<span class="sd">        be between 0 and 100 inclusive. For example, a 95% confidence interval can </span>
<span class="sd">        be specified as `interval = [2.5, 97.5]` or multiple percentiles (e.g. 10, </span>
<span class="sd">        50 and 90) as `interval = [10, 50, 90]`.</span>
<span class="sd">        - If &#39;bootstrapping&#39; (str): `n_boot` bootstrapping predictions will be generated.</span>
<span class="sd">        - If scipy.stats distribution object, the distribution parameters will</span>
<span class="sd">        be estimated for each prediction.</span>
<span class="sd">        - If None, no probabilistic predictions are estimated.</span>
<span class="sd">    interval_method : str, default &#39;bootstrapping&#39;</span>
<span class="sd">        Technique used to estimate prediction intervals. Available options:</span>

<span class="sd">        + &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction </span>
<span class="sd">        intervals.</span>
<span class="sd">        + &#39;conformal&#39;: Employs the conformal prediction split method for </span>
<span class="sd">        interval estimation.</span>
<span class="sd">    alpha : float, default None</span>
<span class="sd">        The confidence intervals used in ForecasterSarimax are (1 - alpha) %. </span>
<span class="sd">    n_boot : int, default `250`</span>
<span class="sd">        Number of bootstrapping iterations to perform when estimating prediction</span>
<span class="sd">            intervals.</span>
<span class="sd">    use_in_sample_residuals : bool, default True</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of prediction </span>
<span class="sd">        error to create prediction intervals.  If `False`, out_sample_residuals </span>
<span class="sd">        are used if they are already stored inside the forecaster.</span>
<span class="sd">    use_binned_residuals : bool, default True</span>
<span class="sd">        If `True`, residuals are selected based on the predicted values </span>
<span class="sd">        (binned selection).</span>
<span class="sd">        If `False`, residuals are selected randomly.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Seed for the random number generator to ensure reproducibility.</span>
<span class="sd">    return_predictors : bool, default False</span>
<span class="sd">        If `True`, the predictors used to make the predictions are also returned.</span>
<span class="sd">    n_jobs : int, &#39;auto&#39;, default `&#39;auto&#39;`</span>
<span class="sd">        The number of jobs to run in parallel. If `-1`, then the number of jobs is </span>
<span class="sd">        set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<span class="sd">        skforecast.utils.select_n_jobs_fit_forecaster.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default False</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the backtesting </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    suppress_warnings_fit : bool, default False</span>
<span class="sd">        If `True`, warnings generated during fitting will be ignored. Only </span>
<span class="sd">        `ForecasterSarimax`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="n">cv_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">!=</span> <span class="s2">&quot;TimeSeriesFold&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`cv` must be a &#39;TimeSeriesFold&#39; object. Got &#39;</span><span class="si">{</span><span class="n">cv_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

    <span class="n">steps</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">steps</span>
    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">initial_train_size</span>
    <span class="n">gap</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">gap</span>
    <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">allow_incomplete_fold</span>
    <span class="n">refit</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">refit</span>

    <span class="n">forecasters_uni</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterSarimax&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_direct</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterRnn&quot;</span>
    <span class="p">]</span>
    <span class="n">forecasters_multi_no_dict</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterRnn&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_multi_dict</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span>
    <span class="p">]</span>
    <span class="c1"># NOTE: ForecasterSarimax has interval but not with bootstrapping or conformal</span>
    <span class="n">forecasters_boot_conformal</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_return_predictors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`y` must be a pandas Series.&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_no_dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`series` must be a pandas DataFrame.&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>

        <span class="c1"># NOTE: Checks are not need as they are done in the function </span>
        <span class="c1"># `check_preprocess_series` that is used before `check_backtesting_input`</span>
        <span class="c1"># in the backtesting function.</span>

        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">serie</span><span class="p">])</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
            <span class="c1"># NOTE: Checks are not need as they are done in the function </span>
            <span class="c1"># `check_preprocess_exog_multiseries` that is used before </span>
            <span class="c1"># `check_backtesting_input` in the backtesting function.</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;differentiation&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">!=</span> <span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation</span><span class="p">,</span> <span class="nb">dict</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;When using a dict as `differentiation` in ForecasterRecursiveMultiSeries, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;the `differentiation` included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">) must be &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;the same as the maximum `differentiation` included in the forecaster &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;for both using the `differentiation` argument.&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The differentiation included in the forecaster &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span><span class="si">}</span><span class="s2">) differs from the differentiation &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;for both using the `differentiation` argument.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`metric` must be a string, a callable function, or a list containing &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;multiple strings and/or callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterEquivalentDate&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">forecaster</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span>
    <span class="p">):</span>
        <span class="c1"># NOTE: Checks when initial_train_size is not None cannot be done here</span>
        <span class="c1"># because the forecaster is not fitted yet and we don&#39;t know the</span>
        <span class="c1"># window_size since pd.DateOffset is not a fixed window size.</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;and smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">) or &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;a date within this range of the index.&quot;</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

        <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
                                 <span class="n">index</span>        <span class="o">=</span> <span class="n">index</span><span class="p">,</span> 
                                 <span class="n">date_input</span>   <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span> 
                                 <span class="n">method</span>       <span class="o">=</span> <span class="s1">&#39;validation&#39;</span><span class="p">,</span>
                                 <span class="n">date_literal</span> <span class="o">=</span> <span class="s1">&#39;initial_train_size&#39;</span>
                             <span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">or</span> <span class="n">initial_train_size</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;and smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">). If &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The total size of `initial_train_size` </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2"> plus &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;`gap` </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2"> cannot be greater than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterEquivalentDate&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer smaller than the &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
                    <span class="s2">&quot;`forecaster` must be already trained if no `initial_train_size` &quot;</span>
                    <span class="s2">&quot;is provided.&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">refit</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s1">&#39;ForecasterSarimax&#39;</span> <span class="ow">and</span> <span class="n">cv</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;`skip_folds` is not allowed for ForecasterSarimax. Set it to `None`.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_aggregated_metric</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`add_aggregated_metric` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_boot</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">n_boot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_boot` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">n_boot</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use_in_sample_residuals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`use_in_sample_residuals` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use_binned_residuals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`use_binned_residuals` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_state</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">random_state</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`random_state` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">random_state</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_predictors</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`return_predictors` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n_jobs</span> <span class="o">!=</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_jobs` must be an integer or `&#39;auto&#39;`. Got </span><span class="si">{</span><span class="n">n_jobs</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_progress</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`show_progress` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`suppress_warnings` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suppress_warnings_fit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`suppress_warnings_fit` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_boot_conformal</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">interval_method</span> <span class="o">==</span> <span class="s1">&#39;conformal&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;When `interval_method` is &#39;conformal&#39;, `interval` must &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;be a float or a list/tuple defining a symmetric interval. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">interval_method</span> <span class="o">==</span> <span class="s1">&#39;bootstrapping&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="s2">&quot;_pdf&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="s2">&quot;fit&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)))</span>
                <span class="p">):</span>                
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;When `interval_method` is &#39;bootstrapping&#39;, `interval` &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;must be a float, a list or tuple of floats, a &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;scipy.stats distribution object (with methods `_pdf` and &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;`fit`) or the string &#39;bootstrapping&#39;. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interval</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;`interval` must be a list or tuple of floats. &quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2">.&quot;</span>
                            <span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">interval</span><span class="p">:</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mf">100.</span><span class="p">):</span>
                                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                    <span class="s2">&quot;When `interval` is a list or tuple, all values must be &quot;</span>
                                    <span class="s2">&quot;between 0 and 100 inclusive.&quot;</span>
                                <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">interval</span> <span class="o">!=</span> <span class="s1">&#39;bootstrapping&#39;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;When `interval` is a string, it must be &#39;bootstrapping&#39;.&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2">.&quot;</span>
                        <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;`interval_method` must be &#39;bootstrapping&#39; or &#39;conformal&#39;. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">interval_method</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_predictors</span> <span class="ow">and</span> <span class="n">forecaster_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecasters_return_predictors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`return_predictors` is only allowed for forecasters of type &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">forecasters_return_predictors</span><span class="si">}</span><span class="s2">. Got </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="n">allow_incomplete_fold</span>
        <span class="ow">and</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">data_length</span> <span class="o">-</span> <span class="p">(</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">steps</span>
    <span class="p">):</span>        
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;There is not enough data to evaluate </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2"> steps in a single &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;fold. Set `allow_incomplete_fold` to `True` to allow incomplete folds.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;    Data available for test : </span><span class="si">{</span><span class="n">data_length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;    Steps                   : </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># TODO: Review when unify steps and max_step</span>
    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_direct</span><span class="p">:</span>
        <span class="n">max_step</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">steps</span> <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">!=</span> <span class="s2">&quot;ForecasterRnn&quot;</span> <span class="k">else</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">max_step</span>
        <span class="k">if</span> <span class="n">max_step</span> <span class="o">&lt;</span> <span class="n">steps</span> <span class="o">+</span> <span class="n">gap</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;When using a </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">, the combination of steps &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;+ gap (</span><span class="si">{</span><span class="n">steps</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="si">}</span><span class="s2">) cannot be greater than the `steps` parameter &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;declared when the forecaster is initialized (</span><span class="si">{</span><span class="n">max_step</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._utils.check_one_step_ahead_input" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._utils.check_one_step_ahead_input</span>


<a href="#skforecast.model_selection._utils.check_one_step_ahead_input" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">check_one_step_ahead_input</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>This is a helper function to check most inputs of hyperparameter tuning
functions in modules <code>model_selection</code> when using a <code>OneStepAheadFold</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="Forecaster">Forecaster</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.model_selection._split.OneStepAheadFold" href="#skforecast.model_selection._split.OneStepAheadFold">OneStepAheadFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>OneStepAheadFold object with the information needed to split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for uni-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for multi-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the hyperparameter 
search. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_one_step_ahead_input</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">cv</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a helper function to check most inputs of hyperparameter tuning</span>
<span class="sd">    functions in modules `model_selection` when using a `OneStepAheadFold`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    cv : OneStepAheadFold</span>
<span class="sd">        OneStepAheadFold object with the information needed to split the data into folds.</span>
<span class="sd">    metric : str, Callable, list</span>
<span class="sd">        Metric used to quantify the goodness of fit of the model.</span>
<span class="sd">    y : pandas Series, default None</span>
<span class="sd">        Training time series for uni-series forecasters.</span>
<span class="sd">    series : pandas DataFrame, dict, default None</span>
<span class="sd">        Training time series for multi-series forecasters.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default None</span>
<span class="sd">        Exogenous variables.</span>
<span class="sd">    show_progress : bool, default True</span>
<span class="sd">        Whether to show a progress bar.</span>
<span class="sd">    suppress_warnings: bool, default False</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the hyperparameter </span>
<span class="sd">        search. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="n">cv_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">!=</span> <span class="s2">&quot;OneStepAheadFold&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`cv` must be a &#39;OneStepAheadFold&#39; object. Got &#39;</span><span class="si">{</span><span class="n">cv_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">initial_train_size</span>

    <span class="n">forecasters_one_step_ahead</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterRecursiveMultiSeries&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ForecasterDirectMultiVariate&#39;</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecasters_one_step_ahead</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Only forecasters of type </span><span class="si">{</span><span class="n">forecasters_one_step_ahead</span><span class="si">}</span><span class="s2"> are allowed &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;when using `cv` of type `OneStepAheadFold`. Got </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">forecasters_uni</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_multi_no_dict</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">forecasters_multi_dict</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`y` must be a pandas Series. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_no_dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`series` must be a pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

    <span class="c1"># TODO: Review checks for long-format and redundant</span>
    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>

        <span class="c1"># NOTE: Checks are not need as they are done in the function </span>
        <span class="c1"># `check_preprocess_series` that is used before `check_one_step_ahead_input`</span>
        <span class="c1"># in the backtesting function.</span>

        <span class="n">data_name</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">serie</span><span class="p">])</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
            <span class="c1"># NOTE: Checks are not need as they are done in the function </span>
            <span class="c1"># `check_preprocess_exog_multiseries` that is used before </span>
            <span class="c1"># `check_backtesting_input` in the backtesting function.</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s1">&#39;differentiation&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">!=</span> <span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation</span><span class="p">,</span> <span class="nb">dict</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;When using a dict as `differentiation` in ForecasterRecursiveMultiSeries, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;the `differentiation` included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">) must be &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;the same as the maximum `differentiation` included in the forecaster &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;for both using the `differentiation` argument.&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The differentiation included in the forecaster &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span><span class="si">}</span><span class="s2">) differs from the differentiation &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;for both using the `differentiation` argument.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`metric` must be a string, a callable function, or a list containing &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;multiple strings and/or callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
                             <span class="n">index</span>        <span class="o">=</span> <span class="n">index</span><span class="p">,</span> 
                             <span class="n">date_input</span>   <span class="o">=</span> <span class="n">initial_train_size</span><span class="p">,</span> 
                             <span class="n">method</span>       <span class="o">=</span> <span class="s1">&#39;validation&#39;</span><span class="p">,</span>
                             <span class="n">date_literal</span> <span class="o">=</span> <span class="s1">&#39;initial_train_size&#39;</span>
                         <span class="p">)</span>
    <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">or</span> <span class="n">initial_train_size</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">). If &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_progress</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`show_progress` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`suppress_warnings` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">suppress_warnings</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;One-step-ahead predictions are used for faster model comparison, but they &quot;</span>
            <span class="s2">&quot;may not fully represent multi-step prediction performance. It is recommended &quot;</span>
            <span class="s2">&quot;to backtest the final model for a more accurate multi-step performance &quot;</span>
            <span class="s2">&quot;estimate.&quot;</span><span class="p">,</span> <span class="n">OneStepAheadValidationWarning</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="skforecast.model_selection._utils.select_n_jobs_backtesting" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">skforecast.model_selection._utils.select_n_jobs_backtesting</span>


<a href="#skforecast.model_selection._utils.select_n_jobs_backtesting" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">select_n_jobs_backtesting</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">refit</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">

        <p>Select the optimal number of jobs to use in the backtesting process. This
selection is based on heuristics and is not guaranteed to be optimal.</p>
<p>The number of jobs is chosen as follows:</p>
<ul>
<li>If <code>refit</code> is an integer, then <code>n_jobs = 1</code>. This is because parallelization doesn't 
work with intermittent refit.</li>
<li>If forecaster is 'ForecasterRecursive' and regressor is a linear regressor, 
then <code>n_jobs = 1</code>.</li>
<li>If forecaster is 'ForecasterRecursive' and regressor is not a linear 
regressor then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterDirect' or 'ForecasterDirectMultiVariate'
and <code>refit = True</code>, then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterDirect' or 'ForecasterDirectMultiVariate'
and <code>refit = False</code>, then <code>n_jobs = 1</code>.</li>
<li>If forecaster is 'ForecasterRecursiveMultiSeries', then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterSarimax' or 'ForecasterEquivalentDate', 
then <code>n_jobs = 1</code>.</li>
<li>If regressor is a <code>LGBMRegressor(n_jobs=1)</code>, then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If regressor is a <code>LGBMRegressor</code> with internal n_jobs != 1, then <code>n_jobs = 1</code>.
This is because <code>lightgbm</code> is highly optimized for gradient boosting and
parallelizes operations at a very fine-grained level, making additional
parallelization unnecessary and potentially harmful due to resource contention.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="Forecaster">Forecaster</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refit</code>
            </td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the forecaster is refitted during the backtesting process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>n_jobs</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skforecast\model_selection\_utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_n_jobs_backtesting</span><span class="p">(</span>
    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select the optimal number of jobs to use in the backtesting process. This</span>
<span class="sd">    selection is based on heuristics and is not guaranteed to be optimal.</span>

<span class="sd">    The number of jobs is chosen as follows:</span>

<span class="sd">    - If `refit` is an integer, then `n_jobs = 1`. This is because parallelization doesn&#39;t </span>
<span class="sd">    work with intermittent refit.</span>
<span class="sd">    - If forecaster is &#39;ForecasterRecursive&#39; and regressor is a linear regressor, </span>
<span class="sd">    then `n_jobs = 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterRecursive&#39; and regressor is not a linear </span>
<span class="sd">    regressor then `n_jobs = cpu_count() - 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterDirect&#39; or &#39;ForecasterDirectMultiVariate&#39;</span>
<span class="sd">    and `refit = True`, then `n_jobs = cpu_count() - 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterDirect&#39; or &#39;ForecasterDirectMultiVariate&#39;</span>
<span class="sd">    and `refit = False`, then `n_jobs = 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterRecursiveMultiSeries&#39;, then `n_jobs = cpu_count() - 1`.</span>
<span class="sd">    - If forecaster is &#39;ForecasterSarimax&#39; or &#39;ForecasterEquivalentDate&#39;, </span>
<span class="sd">    then `n_jobs = 1`.</span>
<span class="sd">    - If regressor is a `LGBMRegressor(n_jobs=1)`, then `n_jobs = cpu_count() - 1`.</span>
<span class="sd">    - If regressor is a `LGBMRegressor` with internal n_jobs != 1, then `n_jobs = 1`.</span>
<span class="sd">    This is because `lightgbm` is highly optimized for gradient boosting and</span>
<span class="sd">    parallelizes operations at a very fine-grained level, making additional</span>
<span class="sd">    parallelization unnecessary and potentially harmful due to resource contention.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    forecaster : Forecaster</span>
<span class="sd">        Forecaster model.</span>
<span class="sd">    refit : bool, int</span>
<span class="sd">        If the forecaster is refitted during the backtesting process.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n_jobs : int</span>
<span class="sd">        The number of jobs to run in parallel.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">):</span>
        <span class="n">regressor</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">regressor_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">regressor</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">regressor</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span>
        <span class="n">regressor_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">regressor</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="n">linear_regressors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">regressor_name</span>
        <span class="k">for</span> <span class="n">regressor_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">sklearn</span><span class="o">.</span><span class="n">linear_model</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">regressor_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">refit</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">refit</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterRecursive&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">regressor_name</span> <span class="ow">in</span> <span class="n">linear_regressors</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">regressor_name</span> <span class="o">==</span> <span class="s1">&#39;LGBMRegressor&#39;</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">regressor</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterDirect&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterDirectMultiVariate&#39;</span><span class="p">]:</span>
            <span class="c1"># Parallelization is applied during the fitting process.</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterRecursiveMultiSeries&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">regressor_name</span> <span class="o">==</span> <span class="s1">&#39;LGBMRegressor&#39;</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">regressor</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ForecasterSarimax&#39;</span><span class="p">,</span> <span class="s1">&#39;ForecasterEquivalentDate&#39;</span><span class="p">]:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">n_jobs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2030 Joaquín Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/skforecast/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/skforecast/skforecast" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/3V52qpNkuj" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener" title="creativecommons.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="m253.8 214.9-33.2 17.3c-9.4-19.6-25.2-19.9-27.5-19.9-22.1 0-33.2 14.6-33.2 43.8 0 23.6 9.2 43.8 33.2 43.8 14.5 0 24.6-7.1 30.6-21.3l30.6 15.5c-6.2 11.5-25.7 39-65.1 39-22.6 0-74-10.3-74-77 0-58.7 43-77.1 72.6-77.1 30.7 0 52.7 11.9 66 35.9m143 0L364 232.2c-9.5-19.8-25.7-19.9-27.9-19.9-22.1 0-33.2 14.6-33.2 43.8 0 23.5 9.2 43.8 33.2 43.8 14.4 0 24.6-7.1 30.5-21.3l31 15.5c-2.1 3.8-21.4 39-65.1 39-22.7 0-74-9.9-74-77 0-58.7 43-77.1 72.6-77.1 30.7 0 52.6 11.9 65.6 35.9zM255.6 8C112.7 8 8 123.1 8 256.1c0 138.4 113.6 248 247.6 248 129.9 0 248.4-100.9 248.4-248C504 118.2 397.4 8 255.6 8m.9 450.8c-112.5 0-203.7-93-203.7-202.8 0-105.4 85.4-203.3 203.7-203.3 112.5 0 202.8 89.5 202.8 203.3 0 121.7-99.7 202.8-202.8 202.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "toc.integrate", "navigation.breadcrumbs"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../javascripts/version-switcher.js"></script>
      
    
  </body>
</html>